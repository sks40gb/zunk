/*
 * CreateProjectDialog.java
 *
 * Created on September 2, 2008, 3:26 PM
 */

package ui;

import beans.LUpperCaseTextField;
import client.TaskAddNewProject;
import common.msg.MessageConstants;
import javax.swing.JOptionPane;
import org.w3c.dom.Element;
/**
 *  This class is used to create new projects.
 * @author  anuragg
 */
public class CreateProjectDialog extends javax.swing.JDialog {
   
   /** Creates new form CreateProjectDialog */
   public CreateProjectDialog(java.awt.Frame parent, boolean modal) {
      super(parent, modal);
      initComponents();
   }
   
   /** This method is called from within the constructor to
    * initialize the form.
    * WARNING: Do NOT modify this code. The content of this method is
    * always regenerated by the Form Editor.
    */
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {
        java.awt.GridBagConstraints gridBagConstraints;

        headingLabel = new javax.swing.JLabel();
        projectLabel = new javax.swing.JLabel();
        projectTextField = new LUpperCaseTextField();
        addProjectButton = new javax.swing.JButton();
        cancelButton = new javax.swing.JButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        setTitle("Create Project");
        setBackground(java.awt.Color.white);
        setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));
        getContentPane().setLayout(new java.awt.GridBagLayout());

        headingLabel.setFont(new java.awt.Font("Dialog", 1, 18));
        headingLabel.setText("Create Project");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.gridwidth = java.awt.GridBagConstraints.REMAINDER;
        gridBagConstraints.ipadx = 17;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(10, 132, 8, 37);
        getContentPane().add(headingLabel, gridBagConstraints);

        projectLabel.setFont(new java.awt.Font("Tahoma", 0, 12));
        projectLabel.setText("Project Name :");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.ipadx = 4;
        gridBagConstraints.ipady = 9;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.EAST;
        getContentPane().add(projectLabel, gridBagConstraints);

        projectTextField.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                projectTextFieldKeyReleased(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.ipadx = 200;
        gridBagConstraints.ipady = 3;
        gridBagConstraints.insets = new java.awt.Insets(54, 43, 63, 10);
        getContentPane().add(projectTextField, gridBagConstraints);

        addProjectButton.setText("Add Project");
        addProjectButton.setEnabled(false);
        addProjectButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                addProjectButtonActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.gridheight = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.insets = new java.awt.Insets(0, 60, 0, 0);
        getContentPane().add(addProjectButton, gridBagConstraints);

        cancelButton.setText("Cancel");
        cancelButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cancelButtonActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.gridheight = 2;
        gridBagConstraints.insets = new java.awt.Insets(10, 10, 10, 5);
        getContentPane().add(cancelButton, gridBagConstraints);

        pack();
    }// </editor-fold>//GEN-END:initComponents

   /**
    * This method is invoked on click event of Add Project button.
    * It validates the project name specified whether its empty or it already exists.
    * Then it add the new project and disposes out the Create Project dialog.
    * @param evt : ActionEvent object
    */
   private void addProjectButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_addProjectButtonActionPerformed
      String projectName = projectTextField.getText();
      if(projectName == null || projectName.trim().length() == 0){
         JOptionPane.showMessageDialog(this, "Please specify the project name","Alert",JOptionPane.INFORMATION_MESSAGE);
         projectTextField.requestFocus();
      }else{
         projectTextField.requestFocus();
         final TaskAddNewProject task = new TaskAddNewProject(projectName.trim());
         task.setCallback(new Runnable() {
                       public void run() {                           
                           Element reply = (Element) task.getResult();
                           String action = reply.getNodeName();                                                      
                           if(MessageConstants.T_FAIL.equals(action)){
                              JOptionPane.showMessageDialog(null,"","Error",JOptionPane.ERROR_MESSAGE);                              
                           }else{
                              JOptionPane.showMessageDialog(null,"Project has been added successfully."
                                      ,"Added",JOptionPane.INFORMATION_MESSAGE);
                              dispose();
                           }                           
                       }});
         task.enqueue(this);
      }
}//GEN-LAST:event_addProjectButtonActionPerformed

   /**
    * This method is invoked when Cancel button is pressed.
    * It perform the disposal of the Create Project dialog.
    * @param evt : ActionEvent object
    */
   private void cancelButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cancelButtonActionPerformed
      dispose();
   }//GEN-LAST:event_cancelButtonActionPerformed

private void projectTextFieldKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_projectTextFieldKeyReleased
    if(projectTextField.getText().trim().length() == 0)    {
        addProjectButton.setEnabled(false);
    }else{
        addProjectButton.setEnabled(true);
    }        
}//GEN-LAST:event_projectTextFieldKeyReleased
   
  
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton addProjectButton;
    private javax.swing.JButton cancelButton;
    private javax.swing.JLabel headingLabel;
    private javax.swing.JLabel projectLabel;
    private javax.swing.JTextField projectTextField;
    // End of variables declaration//GEN-END:variables
   
}
