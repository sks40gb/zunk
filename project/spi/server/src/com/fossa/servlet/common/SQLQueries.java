package com.fossa.servlet.common;

/**
 * string variable assign to hold sql queries 
 */
public interface  SQLQueries {

     String SEL_VOL_BATCH = "SELECT volume_id, batch_id FROM session WHERE live = 1 and session_id = ";
     String UPD__SESSION = "update session set interaction_time=? where session_id = ?";
     String SEL_SERVER_INSTANCE = "SELECT server_instance_count FROM svradmin with (UPDLOCK) WHERE dummy_key = 0";
     String INS_SESSION_VALUES = "INSERT INTO session(server_nbr,start_time,interaction_time) values(?,?,?)";
     String SEL_SESSION_ID = "SELECT TOP 1 session_id FROM session ORDER BY session_id DESC";
     String DROP_TEMP_TBL = "IF EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[#TEMP]') AND type in (N'U')) DROP TABLE [dbo].[#TEMP]";
     String SEL_SER_INSTANCE = "SELECT server_instance_count FROM svradmin  with (UPDLOCK) WHERE dummy_key = 0 ";
     String UPD_SERVER = "update svradmin set server_instance_count = ? where dummy_key = 0";
     String SEL_BATCH_NO = "SELECT B.batch_number,X.rework,X.qa_rework,B.active_group,B.treatment_level FROM batch B with (UPDLOCK) left join batchuser X on X.batch_id = B.batch_id WHERE B.volume_id =  ?  and B.batch_id = ? and B.status = ?";
     String SEL_COMMENT = "select comments from batch_comments where batch_id=";
     String SEL_SUBSTRING = "SELECT SUBSTRING(CONVERT(VARCHAR(16), GETDATE(), 120), 1, 16) AS [YY-MM-DD],user_name FROM users WHERE users_id =";
     String UPD_BATCH = "UPDATE batch_comments SET batch_id = ? ,comments= ?";
     String INS_CHILD = "INSERT into childcoded(child_id, status, users_id) select C.child_id, 'CodingQC', ? from child C left join childcoded CC on C.child_id = CC.child_id and CC.round = 0 where C.batch_id= ? and CC.child_id is null";
     String INS_BATCH_CREDIT = "INSERT INTO batchcredit(batch_id, project_id, volume_id,batch_number,credit_time,users_id,status,field_level,rework,child_count,page_count,active_group) SELECT ?,V.project_id,V.volume_id,?,?,(dbo.fn_Unitize(B.status, U.coder_id, U.qc_id)),?,0,?,count(distinct C.child_id),count(*),? FROM page P inner join child C ON C.child_id = P.child_id inner join batch B on B.batch_id = C.batch_id inner join volume V on V.volume_id = B.volume_id inner join project PR on PR.project_id = V.project_id left join batchuser U on U.batch_id=C.batch_id WHERE B.batch_id=? GROUP BY B.batch_id,V.project_id,V.volume_id,B.status,U.coder_id,U.qc_id";
     String INS_BATCH_CREDIT1 = "INSERT INTO batchcredit(batch_id, project_id, volume_id,batch_number,credit_time,users_id,status,field_level,rework,child_count,page_count,active_group) SELECT ?,V.project_id,V.volume_id,?,?,(dbo.fn_Unitize(B.status, U.coder_id, U.qc_id)),?,0,?,count(distinct C.child_id),count(*),? FROM project_l1 P inner join child C ON C.child_id = P.child_id inner join batch B on B.batch_id = C.batch_id inner join volume V on V.volume_id = B.volume_id inner join project PR on PR.project_id = V.project_id left join batchuser U on U.batch_id=C.batch_id WHERE B.batch_id=? GROUP BY B.batch_id,V.project_id,V.volume_id,B.status,U.coder_id,U.qc_id";
     String UPD_BATCH_USR = "update batchuser set last_unitized_page_id = 0 where batch_id=";
     String INS_BATCH_CRDT1 = "INSERT INTO batchcredit(batch_id,project_id,volume_id,batch_number,credit_time ,users_id,status, field_level ,rework, child_count ,page_count, active_group) SELECT ?, V.project_id ,V.volume_id , ?,?,coalesce(X.users_id, 0),?,coalesce(T.field_level, 0),?, count(distinct X.child_id),count(*) , ? from project_l1 P inner join child C on C.child_id = P.child_id inner join volume V on V.volume_id = C.volume_id inner join project PR on PR.project_id = V.project_id left join childcoded X on X.child_id=C.child_id left join value Y on Y.child_id = C.child_id and Y.field_name = PR.level_field_name left join projectfields F on F.project_id = PR.project_id and F.field_name = PR.level_field_name left join tablevalue T on T.tablespec_id = F.tablespec_id and T.value = Y.value WHERE C.batch_id=?   and (X.child_id is null or X.round >= 0) GROUP BY X.users_id, coalesce(T.field_level, 0),V.project_id,V.volume_id";
     String INS_BATCH_CRDT = "INSERT INTO batchcredit(batch_id,project_id,volume_id,batch_number,credit_time ,users_id,status, field_level ,rework, child_count ,page_count, active_group) SELECT ?, V.project_id ,V.volume_id , ?,?,coalesce(X.users_id, 0),?,coalesce(T.field_level, 0),?, count(distinct X.child_id),count(*) , ? from page P inner join child C on C.child_id = P.child_id inner join volume V on V.volume_id = C.volume_id inner join project PR on PR.project_id = V.project_id left join childcoded X on X.child_id=C.child_id left join value Y on Y.child_id = C.child_id and Y.field_name = PR.level_field_name left join projectfields F on F.project_id = PR.project_id and F.field_name = PR.level_field_name left join tablevalue T on T.tablespec_id = F.tablespec_id and T.value = Y.value WHERE C.batch_id=?   and (X.child_id is null or X.round >= 0) GROUP BY X.users_id, coalesce(T.field_level, 0),V.project_id,V.volume_id";
     String INS_BCH_CREDIT = "INSERT INTO batchcredit (batch_id, project_id,volume_id,batch_number, credit_time, users_id, status,rework,active_group)SELECT B.batch_id,V.project_id,V.volume_id,? , ?,?,?, ?, ? from batch B inner join volume V on V.volume_id = B.volume_id left join batchcredit BC on BC.batch_id = B.batch_id and BC.users_id = ? and BC.credit_time = ? WHERE B.batch_id =  ?  and BC.batch_id is null";
     String SEL_MAX_ROUND = "SELECT max(X.round)+1 FROM childcoded X inner join child C ON C.child_id =X.child_id WHERE C.batch_id =";
     String UPD_CHILD = "UPDATE childcoded SET round=? WHERE child_id in (SELECT child_id FROM child WHERE batch_id = ?) and round=0";
     String INS_BATCH_ERROR = "INSERT INTO batcherror (batch_id, users_id, credit_time, round, rework, field_count, change_count, error_count, active_group) SELECT C.batch_id, X.users_id,'+ @now()+',0,0, sum(E.field_count) AS 'sum(E.field_count)',sum(E.change_count) AS 'sum(E.change_count)', sum(E.error_count) AS 'sum(E.error_count)' ,0 FROM childcoded X inner join childerror E ON E.child_id = X.child_id inner join child C ON C.child_id = E.child_id WHERE C.batch_id=1 and X.round=1 GROUP BY users_id,C.batch_id";
     String DEL_CHILD_ERROR = "DELETE from childerror  WHERE child_id in (select child_id from child WHERE batch_id=1)";
     String UPD_BCH = "UPDATE batch SET status = 'UComplete' WHERE volume_id = 1 and batch_id = 1";
     String UPD_VOL_ID = " UPDATE SESSION SET volume_id=0,batch_id=0 WHERE volume_id=? and batch_id=?";
     String DEL_ASSIGN = "delete from assignment where batch_id=";
     String INS_USER_QUEUE = "INSERT INTO usersqueue (users_id, batch_id, timestamp) SELECT coder_id, batch_id,'+@NOW()+' FROM batchuser WHERE batch_id =";
     String UPD_REWORK = "UPDATE batchuser SET rework=1 WHERE batch_id=";
     String INS_USR_QUEUE = "INSERT INTO usersqueue (users_id, batch_id, timestamp) SELECT qc_id,batch_id,'+@NOW()+' FROM batchuser WHERE batch_id =1";
     String INS_TEAMS_QUEUE = "INSERT INTO teamsqueue (teams_id, batch_id, timestamp) SELECT teams_id,?,'+@NOW+' from users WHERE users_id =? and teams_id != 0";
     String SEL_VOLUME_ID = "SELECT B.volume_id, P.high_coding_batch, B.lft, B.rgt, P.project_id, active_group, treatment_level FROM batch B inner join volume V on V.volume_id = B.volume_id inner join project P on P.project_id = V.project_id WHERE B.batch_id = ? and B.status = 'Ucomplete'";
     String INS_LFT = "INSERT INTO batch (volume_id, lft, rgt, batch_number, status, active_group,treatment_level) VALUES (?,?,?,?,'Coding', ?,?)";
     String UPD_CHILD_TOP = "UPDATE child set batch_id=(SELECT TOP 1 batch_id FROM batch ORDER BY batch_id DESC) WHERE volume_id=? AND lft BETWEEN ? AND ?";
     String SEL_CLFT = "SELECT C.lft, C.rgt, dbo.fn_RGT(C.rgt,R.rgt) ,C.child_id FROM child C inner join range R on R.range_id = C.range_id WHERE C.volume_id=? and C.lft between ? and ? ORDER BY C.lft";
     String UPD_PROJECT = "UPDATE project  SET high_coding_batch=?  WHERE project_id=?";
     String UPD_BATCH_STATUS = "UPDATE batch SET status = 'UBatched' WHERE batch_id = ?";
     String SEL_TOP_FUNC = "SELECT top 1 NB.batch_id, C.lft, dbo.fn_NEWStatus(B.status,NB.status,S.batch_id,NS.batch_id) FROM child C inner join batch B ON B.batch_id = C.batch_id inner join batch NB ON NB.volume_id = B.volume_id left join session S on S.batch_id=B.batch_id left join session NS on S.batch_id=NB.batch_id WHERE C.child_id=1 and NB.volume_id = C.volume_id and NB.lft > C.rgt ORDER BY NB.lft";
     String DEL_BATCH = "delete from batch where batch_id=";
     String UPD_RGT = "UPDATE batch SET rgt=? WHERE batch_id=?";
     String UPD_PROJ_UNITIZE = "UPDATE project SET high_unitize_batch=? WHERE project_id=?";
     String UPD_PROJ_CODING = "UPDATE project SET high_coding_batch=? WHERE project_id=?";
     String UPD_CHILD_BATCH = "UPDATE child SET batch_id= (SELECT TOP 1 batch_id FROM batch ORDER BY batch_id DESC) WHERE batch_id=? and rgt >= ?";
     String INS_LFT_RGT = "INSERT INTO batch VALUES( ?,?,?,?,?,?,?)";
     String UPD_RGT_BATCH = "UPDATE batch SET rgt=? WHERE batch_id=?";
     String UPD_BATCHID = "update child set batch_id = ? where batch_id = ? and rgt >=?";
     String UPD_BATCHLFT = "update batch set lft=? where batch_id=?";
     String UPD_BATCHRGT = "update batch set rgt=? where batch_id=?";
     String SEL_RGT = "select top 1 rgt from child C where batch_id=? and rgt<? order by rgt desc";
     String UPD_CHILD_BATCHID = "update child set batch_id=? where batch_id=? and lft <= ?";
     String UPD_BATCH_RGT = "update batch set rgt= ? where batch_id=?";
     String UPD_BATCH_LFT = "update batch set lft=? where batch_id=?";
     String SEL_LFT = "select top 1 lft from child where batch_id=? and lft>? order by lft";
     String DEL_ASSGN = "delete from assignment where batch_id=";
     String DEL_TEAMSQUEUE = "delete from teamsqueue where batch_id=";
     String DEL_USERSQUEUE = "delete from usersqueue where batch_id=";
     String SEL_USER_NAME = "select user_name from users where users_id = ?";
     String INS_CODING_MANUAL = "insert into coding_manual_tracking(user_name,project_id,start_time,end_time,time_spent) values(?,?,?,?,?)";
     String SEL_ASSIGN = "SELECT 0 as '0' FROM assignment A WITH(HOLDLOCK) inner join batch B on B.batch_id = A.batch_id WHERE A.batch_id= ?";
     String DEL_USR_QUEUE = "delete from usersqueue where batch_id = ";
     String DEL_TEAM_QUEUE = "delete from teamsqueue where batch_id = ";
     String SEL_BATCH_ID = "SELECT Top 1 B.batch_id FROM batch B left join assignment A on A.batch_id = B.batch_id WHERE B.volume_id = ? and A.batch_id is null and B.status not like 'QAComplete' and B.status not like 'UBatched' and B.status not like 'UComplete'";
     String INS_TEAMS_VOLUME = "INSERT INTO teamsvolume values(?,?,?)";
     String INSERT_USERS_QUEUE = "INSERT INTO usersqueue(batch_id,users_id,timestamp) VALUES (?,?,?)";
     String INSERT_TEAMS_QUEUE = "INSERT INTO teamsqueue VALUES(?,?,?)";
     String UPD_BATCH_PRIORITY = "update batch set priority = priority+1 where batch_id = ";
     String SELECT_CHILD_ID = "SELECT C.child_id, C.lft, C.rgt , V.project_id, V.sequence, V.image_path,J.project_name, V2.volume_id, V2.lft,B2.batch_id, R2.range_id FROM page P inner join child C ON C.child_id = P.child_id inner join volume V ON V.volume_id = C.volume_id inner join project J ON J.project_id = V.project_id left join volume V2 on V2.project_id = V.project_id and V2.sequence=-1 left join batch B2 on B2.volume_id = V2.volume_id left join range R2 on R2.volume_id = V2.volume_id WHERE P.page_id=? and V.volume_id=? and V.sequence > 0";
     String INSERT_TEST = "INSERT INTO volume VALUES('[?]',default,?,-1,default,default,'*')";
     String INSERT_BATCH_VOLID = "INSERT INTO batch VALUES(?,default,default,default,'Unitize',default,default";
     String INSERT_RANGE = "INSERT INTO range VALUES(?,default,default)";
     String SEL_BINDER = "SELECT TOP 1  0 FROM child WHERE volume_id=? and ? <= child.rgt and ? >= child.lft";
     String UPD_PAGE = "UPDATE page SET boundary='CHILD' WHERE volume_id=? and seq=?";
     String INSERT_CHILD = "INSERT INTO child VALUES(11,600,600,15,4,default)";
     String SELECT_SEQ = "select seq, bates_number, path, filename, offset, file_type, boundary_flag, rotate, page_id from page where child_id=";
     String INSERT_VALUE = "INSERT INTO VALUE (child_id, field_name, sequence, value) SELECT ?, field_name, sequence, value FROM VALUE WHERE child_id=?";
     String INSERT_NAME_VALUE = "INSERT INTO namevalue (child_id, field_name, sequence,last_name, first_name, middle_name, organization, value) SELECT ?, field_name, sequence, last_name, first_name, middle_name, organization, value FROM namevalue WHERE child_id=?";
     String INSERT_LONG_VALUE = "INSERT INTO longvalue (child_id, field_name, sequence, value)  SELECT ?, field_name, sequence, value  FROM longvalue   WHERE child_id=?";
     String SEL_CHILD_VOLUME = "SELECT child_id, V.volume_id FROM page P inner join volume V on V.volume_id = P.volume_id inner join volume V0 on V0.project_id = V.project_id WHERE P.page_id=? and V0.volume_id=? and V.sequence=-1";
     String DEL_P = "DELETE P FROM page P inner join binder_image  on convert(varchar(255),binder_image.page_id)=P.filename WHERE P.child_id=";
     String DEL_CHILD = "delete from child where child_id=";
     String DEL_VALUE = "delete from value where child_id=";
     String DEL_LONG_VALUE = "delete from longvalue where child_id=";
     String DEL_NAME_VALUE = "delete from namevalue where child_id=";
     String SEL_TOP_VOLID = "SELECT TOP 1  volume_id FROM volume ORDER BY volume_id DESC";
     String SEL_TOP_BATCH_ID = "select TOP 1 batch_id from batch order by batch_id DESC";
     String SEL_MIN_LFT = "SELECT min(lft) as 'min(lft)', max(rgt)as 'max(rgt)' FROM child WHERE volume_id=?";
     String UPD_VOLUME_VRB = "UPDATE [Range] SET lft=?, rgt=? FROM [Range] r, volume v, batch B WHERE v.volume_id = ? and r.volume_id = v.volume_id and b.volume_id = v.volume_id";
     String UPD_BOUNDARY = "UPDATE page SET boundary='RANGE' WHERE volume_id=? and seq=?";
     String DEL_V = "DELETE V From volume V,[range] R,batch B Where V.volume_id = ? and R.volume_id = V.volume_id and B.volume_id = V.volume_id";
     String SELECT_STATUS = "select status from batch where batch_id=";
     String UPD_EVENT = "UPDATE event SET close_timestamp =? WHERE users_id=? and volume_id=? and batch_id=? and status=? and close_timestamp=0";
     String SEL_MAX_PF = "SELECT max(PF.field_group) as 'max(PF.field_group)' FROM volume V inner join project P ON P.project_id = V.project_id inner join projectfields PF ON PF.project_id = P.project_id WHERE volume_id=";
     String SEL_MAX_CHILD = "SELECT max(round)as 'max(round)' FROM childcoded CC inner join child C ON C.child_id = CC.child_id inner join batch B ON B.batch_id = C.batch_id WHERE B.volume_id=? and B.status=''";
     String UPD_QA_REWORK = "UPDATE batchuser  SET qa_rework=1 FROM batch B,batchuser BU WHERE B.volume_id=? and B.status='' and B.batch_id = BU.batch_id";
     String SEL_TOP_1 = "SELECT TOP 1 0 FROM childcoded CC inner join child C ON C.child_id = CC.child_id inner join batch B ON B.batch_id = C.batch_id WHERE B.volume_id=? and B.status='' and CC.round=0 and CC.coded_time = 0";
     String UPD_CC = "UPDATE CC SET CC.round = ? FROM childcoded CC,child C,batch B WHERE B.volume_id=? and B.status='Coding'and CC.round=0 and C.child_id = CC.child_id and B.batch_id = C.batch_id";
     String INS_VOLUME_ERROR = "INSERT INTO volumeerror (volume_id, users_id, credit_time, round, rework,  field_count, change_count, error_count) SELECT B.volume_id, X.users_id,?,?,BU.rework,sum(E.field_count),sum(E.change_count),sum(E.error_count) FROM childcoded X inner join childerror E ON E.child_id = X.child_id inner join child C ON C.child_id = E.child_id inner join batch B ON B.batch_id = C.batch_id inner join batchuser BU ON BU.batch_id = B.batch_id WHERE B.volume_id=? and B.status = ''and X.round=1 GROUP BY users_id, BU.rework,B.volume_id";
     String DEL_CE = "DELETE CE FROM childerror CE,child C,batch B WHERE B.volume_id=? and B.status = '' and C.child_id = CE.child_id and B.batch_id = C.child_id";
     String SEL_SUB_STRING = "SELECT SUBSTRING(CONVERT(VARCHAR(16), GETDATE(), 120), 1, 16) AS [YY-MM-DD], user_name FROM users WHERE users_id=";
     String UPD_BC = "UPDATE BC SET BC.comments = convert(varchar(8000),BC.comments) +? FROM batch_comments BC,batch B WHERE B.volume_id=? and B.status='' and B.batch_id = BC.batch_id";
     String INS_DECLARE = "Declare @count_batch_id as int SET @count_batch_id = (SELECT Count(*) from batch_comments where batch_id = @batch_id) If Not(@count_batch_id >0)  INSERT into batch_comments(batch_id, comments)  SELECT batch_id,?  FROM batch WHERE volume_id=? and status=''";
     String UPD_BATCH_MAX = "UPDATE batch SET status = CASE WHEN active_group < ? THEN 'Coding' ELSE ? END, active_group = CASE WHEN(active_group < ?) THEN  active_group+1 ELSE  active_group END WHERE volume_id = ? and status=''";
     String UPD_SET_STATUS = "UPDATE batch SET status = ? WHERE volume_id = ? and status=''";
     String SEL_PROJ_ID = "SELECT project_id,project_name FROM project WHERE project_id=?";
     String SEL_COD_MANUAL = "SELECT codingManual_filepath,project_name FROM coding_manual WHERE project_name=?";
     String UPD_CUSTOMER_PRICE = "UPDATE customerprice SET  unitize_page_price=?, unitize_doc_price=?, coding_page_price=?, coding_doc_price=? WHERE customerprice_id =?";
     String INS_CUSTOMER_PRICE = "INSERT INTO customerprice (project_id, volume_id, field_level,  unitize_page_price, unitize_doc_price,  coding_page_price, coding_doc_price) VALUES (?,?,?,?,?,?,?)";
     String CREATE_TABLE = "CREATE table #TEMP (project_id int not null,  users_id int not null,  coded_count int ,  page_coded_count int ,  qc_count int ,  page_qc_count int,  in_qc_count int,  page_in_qc_count int)";
     String INS_TEMP_PROJID = "INSERT INTO #TEMP (project_id, users_id, coded_count, page_coded_count) SELECT project_id, users_id, sum(child_count), sum(page_count) FROM batchcredit WHERE credit_time between ? and ? and status = 'Coding' and not rework = 0  GROUP BY project_id, users_id,batchcredit.project_id";
     String INS_TEMP_USERID = "INSERT INTO #TEMP (project_id, users_id, qc_count, page_qc_count) SELECT project_id, users_id, sum(child_count), sum(page_count) FROM batchcredit WHERE credit_time between ? and ? and status = 'CodingQC' and not rework = 0 GROUP BY project_id, users_id";
     String INS_TEMP_QCCOUNT = "INSERT INTO #TEMP (project_id, users_id, in_qc_count, page_in_qc_count) SELECT X.project_id, X.users_id, sum(X.child_count), sum(X.page_count) FROM batchcredit X inner join batch B ON B.batch_id = X.batch_id left join batchcredit Y on Y.batch_id=X.batch_id and Y.status = 'CodingQC' and not Y.rework = 0 and Y.credit_time <= ? WHERE X.credit_time <= ? and X.status = 'Coding' and not X.rework = 0 and Y.batch_id is null GROUP BY X.project_id, X.users_id";
     String SEL_P_PROJ = "SELECT P.project_name as '@Project', T.team_name as '@Team', sum(#TEMP.coded_count) as 'Docs Coded', sum(#TEMP.page_coded_count) as 'Pages Coded', sum(#TEMP.qc_count) as 'Docs QCed', sum(#TEMP.page_qc_count) as 'Pages QCed', sum(#TEMP.in_qc_count) as 'Docs in QC', sum(#TEMP.page_in_qc_count) as 'Pages in QC' FROM #TEMP inner join project P on P.project_id = #TEMP.project_id inner join users U on U.users_id=#TEMP.users_id inner join teams T on T.teams_id = U.teams_id GROUP BY project_name, team_name ORDER BY project_name, team_name";
     String SEL_CODED_COUNT = "SELECT P.project_name as '@Project', sum(#TEMP.coded_count) as 'Docs Coded', sum(#TEMP.page_coded_count) as 'Pages Coded', sum(#TEMP.qc_count) as 'Docs QCed', sum(#TEMP.page_qc_count) as 'Pages QCed', sum(#TEMP.in_qc_count) as 'Docs in QC', sum(#TEMP.page_in_qc_count) as 'Pages in QC' FROM #TEMP inner join project P on P.project_id = #TEMP.project_id GROUP BY project_name ORDER BY project_name";
     String SEL_TEAM_NAME = "SELECT T.team_name as '@Team', sum(#TEMP.coded_count) as 'Docs Coded', sum(#TEMP.page_coded_count) as 'Pages Coded', sum(#TEMP.qc_count) as 'Docs QCed', sum(#TEMP.page_qc_count) as 'Pages QCed', sum(#TEMP.in_qc_count) as 'Docs in QC',sum(#TEMP.page_in_qc_count) as 'Pages in QC' FROM #TEMP inner join users U on U.users_id = #TEMP.users_id inner join teams T on T.teams_id = U.teams_id GROUP BY team_name ORDER BY team_name";
     String UPD_MAIL_SENT = "UPDATE mailsent SET status = 'Deleted' WHERE mailsent_id =?";
     String SEL_TOP_ASSIGNMENT = "SELECT TOP 1 0 as '0' FROM assignment A inner join batch B on B.batch_id = A.batch_id inner join volume V on V.volume_id = B.volume_id WHERE project_id=? UNION ALL SELECT 0 FROM session S inner join volume V on V.volume_id = S.volume_id WHERE project_id=?";
     String DEL_PAGEISSUE = "DELETE P FROM pageissue P,volume V WHERE V.project_id=? and V.volume_id = P.volume_id";
     String DEL_BM = "DELETE BM FROM binder_image BM,page P,volume V WHERE V.project_id=? and V.sequence = -1 and P.page_id = BM.page_id and V.volume_id = P.volume_id";
     String DEL_P_PAGE = "DELETE P FROM page P,volume V WHERE V.project_id=? and V.volume_id = P.volume_id";
     String DEL_CC = "DELETE CC FROM childcoded CC,child C,volume V WHERE V.project_id=? and C.child_id = CC.child_id and V.volume_id = C.volume_id";
     String DEL_FC = "DELETE FC FROM fieldchange FC,child C,volume V WHERE V.project_id=? and C.child_id = FC.child_id and V.volume_id = C.volume_id";
     String DEL_V_VALUE = "DELETE V FROM value V,child C,volume VOL WHERE VOL.project_id=? and C.child_id = V.child_id and VOL.volume_id = C.volume_id";
     String DEL_NV = "DELETE NV FROM namevalue NV,child C,volume V WHERE V.project_id=? and C.child_id = NV.child_id and V.volume_id = C.volume_id";
     String DEL_LV = "DELETE LV FROM longvalue LV,child C,volume V WHERE V.project_id=? and C.child_id = LV.child_id and V.volume_id = C.volume_id";
     String DEL_CHILD_ERR = "DELETE CE FROM childerror CE,child C,volume V WHERE V.project_id=? and C.child_id = CE.child_id and V.volume_id = C.volume_id";
     String DEL_C_CHILD = "DELETE FROM child WHERE volume_id in(select volume_id from volume V where V.project_id=?)";
     String UPD_BATCHCREDIT = "UPDATE batchcredit SET batch_id=0 WHERE project_id=?";
     String DEL_BE = "DELETE BE FROM batcherror BE,batch B,volume V WHERE V.project_id=? and B.batch_id = BE.batch_id and V.volume_id = B.volume_id";
     String DEL_BU = "DELETE BU FROM batchuser BU,batch B,volume V WHERE V.project_id=? and B.batch_id = BU.batch_id and V.volume_id = B.volume_id";
     String DEL_TQ = "DELETE FROM teamsqueue where batch_id in (select B.batch_id from batch B,volume v where v.project_id = ? and v.volume_id = B.volume_id)";
     String DEL_UQ = "DELETE FROM usersqueue where batch_id in (select B.batch_id from batch B,volume v where v.project_id = ? and v.volume_id = B.volume_id)";
     String DEL_B = "DELETE FROM batch WHERE volume_id in(select volume_id from volume V where V.project_id=?) ";
     String DEL_R = "DELETE R FROM range R,volume V WHERE V.project_id=? and V.volume_id = R.volume_id";
     String DEL_TV = "DELETE FROM teamsvolume WHERE volume_id in(select volume_id from volume V where V.project_id=?)";
     String DEL_VE = "DELETE VE FROM volumeerror VE,volume V WHERE V.project_id=? and V.volume_id = VE.volume_id";
     String DEL_VOL = "DELETE FROM volume WHERE project_id=?";
     String DEL_PROJ_FIELDS = "DELETE FROM projectfields WHERE project_id=?";
     String DEL_TEAMSVALUE = "DELETE FROM tablevalue WHERE tablespec_id in(select tablespec_id from tablespec TS where TS.project_id = ?)";
     String DEL_TABLESPEC = "DELETE FROM tablespec WHERE project_id=?";
     String UPD_PROJ_ACTIVE = "UPDATE project SET active=0 , level_field_name = null, high_volume = 0 , lft = 0,rgt = 0 WHERE project_id=?";
     String SEL_ASSIGN_A = "SELECT TOP 1 0 FROM assignment A inner join batch B on (B.batch_id = A.batch_id) inner join volume V on (V.volume_id = B.volume_id) WHERE V.volume_id=? UNION ALL SELECT 0 FROM session S, volume V WHERE V.volume_id=? and S.volume_id = V.volume_id";
     String DEL_PG_ISSUE = "DELETE FROM pageissue WHERE volume_id=";
     String DEL_PG = "DELETE  FROM page WHERE volume_id=";
     String DEL_COM_CC = "DELETE CC FROM childcoded CC,child C,volume V WHERE V.volume_id=? and C.child_id = CC.child_id and V.volume_id = C.volume_id";
     String DEL_COM_FC = "DELETE FC FROM fieldchange FC,child C,volume V WHERE V.volume_id=? and C.child_id = FC.child_id and V.volume_id = C.volume_id";
     String DEL_COM_VAL = "DELETE VAL FROM value VAL,child C,volume V WHERE V.volume_id=? and C.child_id  = VAL.child_id and V.volume_id = C.volume_id";
     String DEL_COM_NV = "DELETE NV FROM namevalue NV,child C,volume V WHERE V.volume_id=? and C.child_id = NV.child_id and V.volume_id = C.volume_id";
     String DEL_COM_LV = "DELETE LV FROM longvalue LV,child C,volume V WHERE V.volume_id=? and C.child_id = LV.child_id and V.volume_id = C.volume_id";
     String DEL_COM_CHILD = "DELETE  FROM child WHERE volume_id=?";
     String DEL_COM_BE = "DELETE BE FROM batcherror BE,batch B,volume V WHERE V.volume_id=? and B.batch_id = BE.batch_id and V.volume_id = B.volume_id";
     String DEL_COM_BU = "DELETE BU FROM batchuser BU,batch B,volume V WHERE V.volume_id=? and B.batch_id = BU.batch_id and V.volume_id = B.volume_id";
     String DEL_COM_TQ = "DELETE TQ FROM teamsqueue TQ,batch B,volume V WHERE V.volume_id=? and B.batch_id = TQ.batch_id and V.volume_id = B.volume_id";
     String DEL_COM_UQ = "DELETE UQ FROM usersqueue UQ,batch B,volume V WHERE V.volume_id=? and B.batch_id = UQ.batch_id and V.volume_id = B.volume_id";
     String DEL_FROM_BATCH = "DELETE  FROM batch WHERE volume_id=";
     String DEL_FROM_RANGE = "DELETE  FROM range WHERE volume_id=";
     String DEL_FROM_TEAMSVOL = "DELETE FROM teamsvolume WHERE volume_id=";
     String DEL_VOL_ERROR = "DELETE FROM volumeerror WHERE volume_id=";
     String DEL_FROM_VOLUME = "DELETE FROM volume WHERE volume_id=";
     String DEL_EXPORT = "DELETE FROM export WHERE export_name = ?";
     String SEL_EXPORT_NAME = "SELECT export_name FROM export WHERE export_name=?";
     String UPD_EXPORT = "update export set force_export = ?, uppercase = ?, uppercase_names = ?,field_delimiter = ?,text_qualifier = ?,value_separator = ?,date_format = ?,missing_date = ?,missing_year = ?,missing_month = ?,missing_day = ?,missing_date_character = ?,name_mask1 = ?,name_mask2 = ?,name_mask3 = ?,name_mask4 = ?,brs_format = ? where export_name = ?";   
     String INS_EXPORT = "INSERT INTO export (force_export,uppercase,uppercase_names,field_delimiter,text_qualifier,value_separator,date_format,missing_date,missing_year,missing_month,missing_day,missing_date_character,export_name,name_mask1,name_mask2,name_mask3,name_mask4,brs_format) VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
     String SEL_CM_PROJID = "select project_id,project_name from project where project_id=";
     String SEL_CM = "SELECT coding_manual_id,codingManual_fileName,codingManual_filepath FROM coding_manual WHERE project_name='";
     String SEL_CMEDIT_PROJID = "SELECT project_id,project_name FROM project WHERE project_id=?";
     String UPD_CMEDIT_CM = "UPDATE coding_manual SET codingManual_fileName = ?, codingManual_filepath = ? WHERE project_name =?";
     String SEL_DESC = "select description from projectfields where project_id = ? and field_name = ?";
     String DEL_SESSION = "delete from session where session_id=";
     String SEL_MIN_CLIENT = "SELECT min_client_version, max_client_version, min_supported_version FROM svradmin WHERE dummy_key = 0";    
     String SEL_PASS = "SELECT password, users_id, unitize, uqc, coding, codingqc, qa, team_leader, admin,admin_users, admin_project, admin_batch, admin_edit, admin_import, admin_export, admin_profit, listing, tally FROM users WHERE user_name= ? and active = 1";
     String SEL_SESSIONID = "select session_id, users_id from session where session_key=?";
     String SEL_SESSION_HOLDLOCK = "SELECT 0 FROM session WITH(HOLDLOCK) WHERE users_id = ? and not is_admin =1 and live = 1";
     String UPD_USERS = "update users set password=? where users_id=?";
     String UPD_SESSION_KEY = "UPDATE session   set users_id =?, session_key = ?, is_admin = ?, age = ? , fossa_session_id = ? WHERE session_id=?";
     String UPD_MAIL_RCVD = "update mailreceived set status = ? where mailreceived_id = ?";
     String SEL_SENDER = "select sender_users_id from mailsent where mailsent_id =";
     String UPD_MAILSENT = "update mailsent set status='Deleted' where sender_users_id = ? and mailsent_id = ?";
     String UPD_MAILRECVD = "update mailreceived set status='Deleted' where recipient_users_id = ? and mailsent_id = ?";
     String INS_MAILSENT = "INSERT INTO mailsent(sender_users_id,recipient_list,status,subject,text,time_sent) values(?,?,'Active',?,?,?)";
     String SEL_TOP_SENDERS = "SELECT TOP 1 mailsent_id FROM mailsent ORDER BY sender_users_id DESC";
     String INS_MAIL_RECV = "INSERT INTO mailreceived (recipient_users_id,mailsent_id,status) VALUES(?,?,'New')";
     String SEL_USERSID = "SELECT users_id  FROM users  WHERE active = 1";
     String SEL_PNAME_ATTR = "select project_name from project where project_id=";
     String SEL_OPEN_ASSIGN = "SELECT 0 from assignment A WITH(HOLDLOCK) inner join batch B on B.batch_id = A.batch_id WHERE A.batch_id= ? and users_id= ? and B.status=?";
     String SEL_OPEN_UQUEUE = "SELECT TOP 1 Q.batch_id FROM usersqueue Q inner join batch B on B.batch_id = Q.batch_id inner join volume V on V.volume_id = B.volume_id WHERE Q.users_id= ? and V.project_id=? and B.status=? order by B.priority desc, B.batch_number";
     String SEL_OPEN_TEAMSQUEUE = "SELECT TOP 1 Q.batch_id FROM users U inner join teamsqueue Q on Q.teams_id = U.teams_id inner join batch B on B.batch_id = Q.batch_id inner join volume V on V.volume_id = B.volume_id left join usersqueue UQ on UQ.batch_id=Q.batch_id WHERE U.users_id= ? and V.project_id = ? and B.status=? and UQ.batch_id is null ORDER BY B.priority desc, B.batch_number";
     String SEL_OPEN_USERS = "SELECT TOP 1 Q.batch_id FROM users U  inner join teamsqueue Q on Q.teams_id = U.teams_id  inner join batch B on B.batch_id =Q.batch_id  inner join volume V on V.volume_id = B.volume_id  left join batchuser BU on BU.batch_id = B.batch_id  left join usersqueue UQ on UQ.batch_id=Q.batch_id WHERE U.users_id= ? and V.project_id=? and B.status=? and BU.coder_id <> U.users_id and UQ.batch_id is null ORDER BY B.priority desc, B.batch_number";
     String SEL_OPEN_TEAMSVOL = "SELECT TOP 1 B.batch_id FROM users U    inner join teamsvolume Q on Q.teams_id = U.teams_id    inner join volume V on V.volume_id = Q.volume_id    inner join batch B on B.volume_id = V.volume_id left join assignment A on A.batch_id=B.batch_id left join usersqueue UQ on UQ.batch_id=B.batch_id left join teamsqueue TQ on TQ.batch_id=B.batch_id WHERE U.users_id=? and V.project_id=? and B.status=? and A.batch_id is null and UQ.batch_id is null and TQ.batch_id is null ORDER BY B.priority desc, B.batch_number";
     String SEL_OPEN_USERSID = "SELECT users_id  FROM assignment A WITH(UPDLOCK) inner join batch B on B.batch_id = A.batch_id WHERE A.batch_id=?";
     String INS_OPEN_ASSIGNMENT = "INSERT INTO assignment(batch_id,users_id,timestamp) VALUES(?,?,?)";
     String SEL_OPEN_VOLID = "SELECT V.volume_id, project_name, priority, split_documents, P.project_id, active_group FROM batch B inner join volume V on V.volume_id = B.volume_id inner join project P on P.project_id = V.project_id where batch_id=";
     String DEL_OPEN_USERSQUEUE = "delete from usersqueue where batch_id=";
     String DEL_OPEN_TEAMSQUEUE = "delete from teamsqueue where batch_id=";
     String UPD_OPEN_BATCH = "update batch set priority=0 where batch_id=";
     String INS_OPEN_DEC = "Declare @count_batch_id as int SET @count_batch_id = (SELECT Count(*) from batchuser where batch_id = @batch_id) If Not(@count_batch_id >0)  INSERT into batchuser(batch_id,coder_id,mod_time) VALUES(?,?,?)";
     String UPD_OPEN_QCID = "UPDATE batchuser SET coder_id=?, mod_time=? WHERE batch_id=? ";
     String UPD_OPEN_BATCHUSER = "UPDATE batchuser SET qc_id=?, mod_time=? WHERE batch_id=?";
     String SEL_QA_PROJNAME = "SELECT P.project_name, V.volume_name, split_documents, P.project_id FROM project P inner join volume V on V.project_id = P.project_id left join session S on S.volume_id=V.volume_id and S.batch_id=0 WHERE P.active = 1 and V.volume_id= ? and S.volume_id is null";
     String SEL_PAGE_CHILDID = "SELECT P.child_id, C.is_split, P.bates_number, P.seq, C.lft FROM page P inner join child C on C.child_id = P.child_id WHERE page_id =";
     String SEL_PAGE_BATES = "SELECT TOP 1 P.bates_number, P.seq, C.is_split, P.page_id FROM page P inner join child C on C.child_id = P.child_id WHERE P.seq < ? and P.volume_id= ? ORDER BY P.seq desc";
     String DEL_PAGE = "DELETE FROM page WHERE page_id=";
     String UPD_PAGE_BATES = "UPDATE page SET bates_number=substring(bates_number from 1 for ?) WHERE page_id=?";
     String SEL_PAGE_ISSPLIT = "SELECT is_split FROM child WHERE lft > ?   and volume_id = ? ORDER BY lft LIMIT 1";
     String SEL_PAGE = "SELECT 0 FROM page WHERE volume_id=? and seq=?";
     String INS_PAGE = "insert into page ( volume_id, seq, child_id, bates_number, original_flag, original_rotate, path, filename, offset, file_type, boundary_flag, rotate, boundary ) select volume_id, ?, child_id, ?, original_flag, original_rotate, path, filename, offset, file_type, boundary_flag, rotate, 'NONE' from page where page_id=?";
     String SEL_PAGE_PAGEID = "SELECT TOP 1 page_id from page ORDER BY page_id DESC";
     String UPD_PAGE_BNO = "UPDATE page SET bates_number = ? WHERE page_id=?";
     String UPD_CHILD_SPLIT = "UPDATE child  SET is_split=1 FROM child c,page P WHERE P.page_id= ? and P.child_id = C.child_id";
     String SEL_PAGE_PRID = "SELECT project_id  FROM volume WHERE volume_id=";
     String UPD_PAGE_SEQ = "UPDATE page  SET seq = ? FROM page P,volume V WHERE V.project_id= ? and P.seq >= ?  and V.volume_id = P.volume_id";
     String UPD_PAGE_RGT1 = "UPDATE X SET X.rgt = ?, X.lft =  CASE WHEN X.lft >=?     THEN X.lft+?        ELSE X.lft END    FROM child X,volume V WHERE V.project_id=  ? and X.rgt >= ?  and V.volume_id = X.volume_id";
     String UPD_PAGE_RGT2 = "UPDATE  X  SET X.rgt = ?,X.lft =  CASE WHEN X.lft >=? THEN X.lft+? ELSE X.lft  END  FROM range X,volume V  WHERE V.project_id=? and X.rgt >=? and V.volume_id = X.volume_id";
     String UPD_PAGE_RGT3 = "UPDATE X  SET X.rgt = X.rgt+?,X.lft =  CASE WHEN X.lft >=? THEN X.lft+? ELSE X.lft  END  FROM batch X,volume V  WHERE V.project_id=? and X.rgt >=? and V.volume_id = X.volume_id";
     String UPD_PAGE_RGT4 = "UPDATE volume  SET rgt = ?,lft = CASE WHEN lft >=? THEN lft+? ELSE lft END  WHERE project_id= ? and rgt >=?";
     String UPD_PAGE_PROJRGT = "UPDATE project SET rgt = ? WHERE project_id=? and rgt >=?";
     String UPD_PAGE_CHILDRGT = "UPDATE child SET rgt = ? WHERE volume_id=? and rgt=?";
     String UPD_PAGE_BATCHRGT = "UPDATE batch SET rgt = ? WHERE volume_id=? and rgt=?";
     String UPD_PAGE_RANGE = "UPDATE range SET rgt =?  WHERE volume_id=? and rgt=?";
     String UPD_PAGE_VOLUMERGT = "UPDATE volume SET rgt =?  WHERE volume_id=? and rgt=?";
     String UPD_PAGE_PRGT = "UPDATE project  SET rgt = ? FROM project P,volume V WHERE V.volume_id = ? and P.rgt = ? and V.project_id = P.project_id";
     String SEL_VALUES_CHILDID = "select child_id from page where page_id=";
     String SEL_VALUES_STATUS = "SELECT B.status, count(P.page_id), U.rework, U.qa_rework FROM child C left join page P on (P.child_id = C.child_id) left join batch B on (B.batch_id = C.batch_id) left join batchuser U on (U.batch_id = B.batch_id) WHERE C.child_id =? group by B.batch_id, C.child_id,B.status,U.rework,U.qa_rework";
     String SEL_VALUES_USERID = "SELECT users_id, status FROM childcoded WHERE child_id=";
     String UPD_VALUES_CHILD = "UPDATE childcoded    SET users_id=?, coded_time=? WHERE child_id=? and users_id = 0";
     String INS_VALUES_DEC = "INSERT into childcoded(child_id,status,users_id,coded_time)  VALUES(?,?,?,?)";
     String UPD_VALUES_DEC = "Update childcoded set status=?,users_id=?,coded_time=? where child_id = ?";
     String SEL_VALUES_BATUSR = "SELECT 0 FROM page P0, batchuser U WITH(UPDLOCK)     left join page P      on P.page_id = U.last_unitized_page_id WHERE P0.page_id=? and U.batch_id= ? and (U.last_unitized_page_id = 0 or P0.seq > P.seq)";
     String UPD_VALUES_BATUSR = "UPDATE batchuser SET last_unitized_page_id=? WHERE batch_id=?";
     String SEL_VALUES_TV = "SELECT TV.field_level FROM volume V inner join project P on P.project_id = V.project_id inner join projectfields PF0 on PF0.project_id = P.project_id and PF0.field_name = P.level_field_name inner join value VA on VA.child_id=  ? and VA.field_name = P.level_field_name inner join tablevalue TV on TV.tablespec_id = PF0.tablespec_id and TV.value = VA.value WHERE V.volume_id =?";
     String SEL_VALUES_COUNTP = "SELECT count(*) as 'count(*)' FROM projectfields PF inner join volume V on V.project_id = PF.project_id WHERE V.volume_id = ?and PF.field_level in (0,?)";
     String SEL_VALUES_COUNTF = "SELECT count(*) as 'count(*) ', sum(codererror) as 'sum(codererror)' FROM fieldchange WHERE child_id=";
     String SEL_VALUES_COUNTFC = "SELECT count(*) as 'count(*)', sum(codererror) as 'sum(codererror)' FROM fieldchange FC,volume V,projectfields PF WHERE child_id= ? and PF.project_id = V.project_id    and PF.field_name = FC.field_name and V.volume_id= ? and PF.field_level in (0,?)";
     String UPDATE_CHILDERROR_VALUES = "UPDATE childerror SET  field_count=?  , change_count=?  , error_count=?  where child_id=?";
     String SEL_PGISSUE_MAX = "SELECT MAX(sequence)as 'MAX(sequence)' FROM pageissue";
     String INS_PGISSUE_PGID = "INSERT INTO pageissue (page_id, sequence, issue_name) VALUES (?,?,?)";
     String DEL_PGISSUE_PGID = "DELETE FROM pageissue WHERE page_id=? and sequence=?";
     String UPD_PGISSUE_NAME = "UPDATE pageissue SET issue_name=? WHERE page_id=?  and sequence=?";
     String SEL_PGISSUE_TOP = "SELECT TOP 1 sequence, issue_name FROM pageissue WHERE page_id =? and sequence < ? ORDER BY sequence desc";
     String DEL_PGISSUE_SEQ = "DELETE FROM pageissue WHERE page_id = ? and sequence =?";
     String UPD_PGISSUE_PGID = "UPDATE pageissue SET sequence = ?  WHERE page_id =? and sequence =?";
     String INS_PGISSUE_SEQ = "INSERT INTO pageissue (page_id, sequence, issue_name) VALUES (?,?,?)";
     String SEL_PGISSUE_SEQ = "SELECT TOP 1 sequence, issue_name FROM pageissue WHERE page_id = ? and sequence > ? ORDER BY sequence";
     String DEL_PGISSUE_PID = "DELETE FROM pageissue WHERE page_id = ?   and sequence =?";
     String UPD_PGISSUE_SETSEQ = "UPDATE pageissue SET sequence = ? WHERE page_id = ? and sequence = ?";
     String INS_PGISSUE_ISSUE = "INSERT INTO pageissue(page_id, sequence, issue_name) VALUES (?,?,?)";
     String SEL_PRF_SEQ = "SELECT sequence, project_id FROM projectfields WHERE projectfields_id =";
     String SEL_PRF_TOP = "SELECT TOP 1 projectfields_id, sequence FROM projectfields WHERE project_id = ?and sequence < ? ORDER BY sequence desc";
     String UPD_PRF_SEQ = "UPDATE projectfields  SET sequence = ? WHERE projectfields_id =?";
     String UPD_PRF_ID = "UPDATE projectfields  SET sequence = ? WHERE projectfields_id =?";
     String SEL_PRF_SEQUENCE = "SELECT sequence, project_id FROM projectfields WHERE projectfields_id =?";
     String SEL_PRF_PRFID = "SELECT TOP 1 projectfields_id, sequence FROM projectfields WHERE project_id = ? and sequence > ? ORDER BY sequence";
     String UPD_PRF_PRFIELDS = "UPDATE projectfields  SET sequence = ? WHERE projectfields_id =?";
     String UPD_PRF_PRFSEQ = "UPDATE projectfields  SET sequence = ? WHERE projectfields_id =?";
     String UPD_PRF_PRFNAME = "UPDATE projectfields SET field_name = ?,field_size = ?, minimum_size = ?, field_type = ?, required = ?,repeated = ?, unitize = ?, default_value = ?,min_value =? , max_value =? , tablespec_id = ?,table_mandatory = ?, mask = ?, valid_chars = ?, invalid_chars = ?,charset = ?, type_field = ?, type_value = ?, spell_check = ?,field_level =? , field_group = ?, tag_name = ?, description = ?,validation_functions_group_id = ?, l1_information = ? WHERE projectfields_id =?";
     String SEL_PRF_MAX = "SELECT max(sequence) FROM projectfields WHERE project_id =";
     String INS_PRF_PRFIELDS = "INSERT INTO projectfields (project_id, sequence, field_name,field_size, minimum_size, field_type, required,repeated, unitize, default_value,min_value, max_value, tablespec_id,table_mandatory, mask, valid_chars, invalid_chars,charset, type_field, type_value, spell_check, field_level,field_group, tag_name,description,validation_functions_group_id,l1_information) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
     String SEL_PRF_PRFIELDS = "SELECT max(projectfields_id) FROM projectfields WHERE project_id =";
     String UPD_PRF_BATCH = "UPDATE batch B, volume V  SET active_group = 1 WHERE V.project_id =? and B.volume_id = V.volume_id and B.active_group = 0";
     String UPD_PRF_FGRP = "UPDATE projectfields SET field_group = 1 WHERE project_id = ? and field_group = 0";
     String SEL_PRF_PROJID = "SELECT projectfields_id, sequence FROM projectfields WHERE project_id = ?  ORDER BY field_group, sequence";
     String UPD_PRF_PFSEQ = "UPDATE projectfields  SET sequence =?  WHERE projectfields_id =?";
     String SEL_PRF_LEVEL = "SELECT level_field_name FROM project WHERE project_id = ?";
     String UPD_PRF_PRJ = "UPDATE project  SET level_field_name = ? WHERE project_id =?";
     String UPD_PRF_LEVEL = "UPDATE project SET level_field_name = null WHERE project_id =";
     String SEL_PRF_UPRICE = "SELECT unitprice_id FROM unitprice WHERE project_id = ? and volume_id = 0 and field_level =?";
     String SEL_PRF_UNITPRICE = "SELECT unitize_page_price, unitize_doc_price,uqc_page_price, uqc_doc_price,coding_page_price, coding_doc_price,codingqc_page_price, codingqc_doc_price FROM unitprice WHERE project_id = ? and volume_id = 0 and field_level = 0";
     String INS_PRF_UNITPRICE = "INSERT INTO unitprice(project_id, volume_id, field_level, unitize_page_price, unitize_doc_price , uqc_page_price, uqc_doc_price, coding_page_price, coding_doc_price, codingqc_page_price, codingqc_doc_price) VALUES (?,0,?,?,?,?,?,?,?,?,?)";
     String SEL_PRF_DISTINCT = "SELECT distinct V.volume_id FROM project P left join volume V  on V.project_id = P.project_id WHERE P.project_id = ? and P.active = 1 and V.sequence > 0";
     String INS_PRF_UPRICE = "INSERT INTO unitprice(project_id, volume_id, field_level, unitize_page_price, unitize_doc_price, uqc_page_price, uqc_doc_price, coding_page_price, coding_doc_price, codingqc_page_price, codingqc_doc_price) VALUES (?,?,?,?,?,?,?,?,?,?,?)";
     String SEL_REQ_CHILDID = "SELECT child_id FROM page WHERE page_id=";
     String UPD_REQ_SESSION = "UPDATE session SET interaction_time =  ? WHERE session_id=?";
     String SEL_MAIL_UNAME = "SELECT U.user_name, MS.recipient_list, MS.text, U2.user_name, MR.status FROM mailreceived MR, users U,mailsent MS,users U2 WHERE MR.mailreceived_id = ? and U.users_id = MS.sender_users_id       and MS.mailsent_id = MR.mailsent_id       and MR.recipient_users_id = U2.users_id";
     String SEL_MAIL_RLIST = "SELECT U.user_name, recipient_list, text, status FROM mailsent join users U on (U.users_id = sender_users_id) WHERE mailsent_id =";
     String CREATE_PRLIST_TABLE = "CREATE table #TEMP(project_id int not null,batch_id int)";
     String INS_PRLIST_TEMP = "INSERT INTO TEMP SELECT V.project_id,  CASE WHEN B.status ='' THEN Q.batch_id ELSE NULL END  as 'if(B.status ='', Q.batch_id, NULL)' FROM usersqueue Q inner join batch B on B.batch_id = Q.batch_id inner join volume V on V.volume_id = B.volume_id WHERE Q.users_id= 1";
     String INS_PRLIST_PID = "INSERT INTO TEMP SELECT V.project_id, CASE WHEN B.status ='' and UQ.batch_id is null THEN Q.batch_id  ELSE   NULL END  FROM users U inner join teamsqueue Q on Q.teams_id = U.teams_id inner join batch B on B.batch_id = Q.batch_id inner join volume V on V.volume_id = B.volume_id left join usersqueue UQ on UQ.batch_id=Q.batch_id WHERE U.users_id= 1";
     String INS_PRLIST_VPID = "INSERT INTO #TEMP SELECT V.project_id,CASE WHEN (BU.coder_id <> U.users_id and B.status = ? and UQ.batch_id is null) THEN Q.batch_id ELSE NULL END  FROM users U inner join teamsqueue Q on Q.teams_id = U.teams_id     inner join batch B on B.batch_id = Q.batch_id inner join volume V on V.volume_id = B.volume_id    left join batchuser BU on BU.batch_id = B.batch_id    left join usersqueue UQ on UQ.batch_id=Q.batch_id WHERE U.users_id=?";
     String INS_PRLIST_DISTINCT = "INSERT INTO #TEMP (project_id) SELECT distinct V.project_id FROM users U  inner join teamsvolume Q on Q.teams_id = U.teams_id  inner join volume V on V.volume_id = Q.volume_id";
     String INS_PRLIST_BATCHID = "INSERT INTO #TEMP SELECT V.project_id, B.batch_id FROM users U  inner join teamsvolume Q on Q.teams_id = U.teams_id  inner join volume V on V.volume_id = Q.volume_id    inner join batch B on B.volume_id = V.volume_id    left join assignment A on A.batch_id=B.batch_id    left join usersqueue UQ on UQ.batch_id=B.batch_id    left join teamsqueue TQ on TQ.batch_id=B.batch_id WHERE U.users_id= ? and B.status=?       and A.batch_id is null       and UQ.batch_id is null       and TQ.batch_id is null";
     String INS_PRLIST_ASSIGN = "INSERT INTO #TEMP (project_id) SELECT V.project_id FROM assignment A  inner join batch B on B.batch_id = A.batch_id  inner join volume V on V.volume_id = B.volume_id WHERE A.users_id=";
     String SEL_PRLIST_ACTIVE = "SELECT project_name,active,project_id FROM project  WHERE active =1";
     String SEL_PRLIST_PNAME = "SELECT P.project_name, count(distinct #TEMP.batch_id), P.project_id FROM #TEMP,project P WHERE P.project_id = #TEMP.project_id GROUP BY P.project_id,P.project_name ORDER BY P.project_name, P.project_id";
     String SEL_REC_ADMIN = "SELECT admin , qa, team_leader FROM users WHERE users_id =";
     String SEL_REC_UNAME = "SELECT user_name FROM users  WHERE active = 1 UNION ALL SELECT T.team_name +', All Team Members' FROM teams T UNION ALL SELECT T.team_name +', Leader '+U.user_name FROM teams T       inner join users U on (T.users_id = U.users_id) UNION ALL SELECT P.project_name+ ', All Teams' FROM project P WHERE active = 1 UNION ALL SELECT P.project_name+ ', All Leaders' FROM project P WHERE active = 1 UNION ALL SELECT 'All Users' UNION ALL SELECT 'All Team Leaders'";
     String SEL_REC_USRNAME = "SELECT U.user_name FROM users U, users U1 WHERE U1.users_id =  ?   and U.teams_id = U1.teams_id    and U.active = 1 UNION ALL SELECT T.team_name+', All Team Members' FROM teams T   inner join users U on (T.teams_id = U.teams_id   and U.users_id = ? ) UNION ALL SELECT DISTINCT P.project_name+ ', All Leaders' FROM project P, teams T, users U, volume V, teamsqueue TQ, batch B WHERE U.users_id = ?   and (U.teams_id = T.teams_id AND TQ.teams_id = T.teams_id)   and TQ.batch_id = B.batch_id   and B.volume_id = V.volume_id   and V.project_id = P.project_id   AND P.active = 1 UNION ALL SELECT DISTINCT P.project_name+ ', All Leaders' FROM project P, users U, volume V, usersqueue UQ, batch B WHERE U.users_id = ?  and (UQ.users_id = U.users_id)   and UQ.batch_id = B.batch_id   and B.volume_id = V.volume_id   and V.project_id = P.project_id   AND P.active =1 UNION ALL SELECT DISTINCT P.project_name+ ', All Leaders' FROM project P, users U, volume V, assignment A, batch B WHERE U.users_id =  ?   and (A.users_id = U.users_id)   and A.batch_id = B.batch_id   and B.volume_id = V.volume_id   and V.project_id = P.project_id   AND P.active = 1 UNION ALL SELECT DISTINCT P.project_name+ ', All Leaders' FROM project P, users U, teams T, volume V, teamsvolume TV, batch B WHERE U.users_id =  ?  and (U.teams_id = T.teams_id AND TV.teams_id = T.teams_id)   and V.volume_id = TV.volume_id   and V.project_id = P.project_id   AND P.active = 1 UNION ALL SELECT T.team_name+', Leader '+U.user_name FROM teams T, users U1, Users U WHERE U1.users_id =  ?  and T.users_id = U.users_id   and U1.teams_id = T.teams_id";
     String UPD_REQUE_UQUEUE = "UPDATE usersqueue SET requeue_time= ?, requeue_users_id=BU.qc_id FROM usersqueue Q,batchuser BU,batch B WHERE Q.batch_id= ? and BU.qc_id= ? and B.status='Coding' and BU.batch_id = Q.batch_id   and B.batch_id  = BU.batch_id";
     String CREATE_TBL_TEMP = "CREATE table #TEMP   (value varchar(255) not null primary key,count int not null,in_table varchar(7) default 'Yes' check(in_table in('No','Yes')))";
     String CREATE_TBL_SWEEP_DB = "CREATE table sweep_database (value varchar(255) not null primary key,count int not null,in_table varchar(7) default 'Yes' check(in_table in('No','Yes')))";
     String INS_SWEEP_TEMP = "INSERT INTO #TEMP SELECT NV.value, count(*),'' FROM tablespec TS, namevalue NV,projectfields PF,volume V,child C WHERE TS.tablespec_id= 1 and PF.tablespec_id = TS.tablespec_id   and  V.project_id = TS.project_id   and  PF.project_id = V.project_id   and  C.volume_id=V.volume_id and C.lft between V.lft and V.rgt   and  NV.child_id = C.child_id and NV.field_name=PF.field_name   GROUP BY NV.value";
     String UPD_SWEEP_TEMP = "UPDATE #TEMP SET in_table='Yes' FROM tablevalue TV,tablespec TS WHERE TS.tablespec_id = ? and TV.value = #TEMP.value and TS.tablespec_id = TV.tablespec_id";
     String INS_SWEEP_INTABLE = "INSERT into #TEMP  SELECT value, 0, 'Yes' FROM tablespec TS inner join tablevalue TV on TV.tablespec_id = TS.tablespec_id  WHERE TS.tablespec_id = ? ORDER BY TV.tablevalue_id";
     String SEL_SWEEP_VALUE = "SELECT value, count,in_table FROM TEMP";
     String UPD_SAMPLE_STATUS = "UPDATE batch SET status ='' WHERE volume_id=? and status = 'QA'";
     String UPD_SAMPLE_BUSER = "UPDATE batch  SET status ='QA' FROM batch B,batchuser BU  WHERE B.volume_id= ? and B.status = 'QCComplete' and BU.coder_id= ? and BU.batch_id = B.batch_id";
     String UPD_SAMPLE_BATCH1 = "UPDATE batch  set status ='QA' FROM batch B,batchuser BU,users U  where B.volume_id= ? and B.status = 'QCComplete' and U.teams_id= ? and BU.batch_id = B.batch_id and BU.coder_id=U.users_id";
     String UPD_SAMPLE_BATCH2 = "UPDATE batch SET status ='QA'  WHERE volume_id=  ?    and status = 'QCComplete'";
     String UPD_SAMPLE_BATCH3 = "UPDATE batch SET status ='QA' WHERE volume_id=   ?   and status = ''";
     String SEL_SAMPLE_TEAMS = "SELECT teams_id, count(*) FROM child C  inner join batch B on B.batch_id = C.batch_id  left join batchuser BU on BU.batch_id = B.batch_id  left join users U on U.users_id = BU.coder_id  left join childcoded CC  on C.child_id=CC.child_id and CC.round=0   WHERE B.volume_id= ? and B.status='QA'     and CC.child_id is null  GROUP BY U.teams_id";
     String INS_SAMPLE_CCOD = "INSERT INTO childcoded (child_id, status) SELECT TOP 1 C.child_id, 'QA' FROM child C  inner join batch B on B.batch_id = C.batch_id  left join batchuser BU on BU.batch_id = B.batch_id  left join users U on U.users_id = BU.coder_id  left join childcoded CC   on C.child_id=CC.child_id and CC.round=0    WHERE B.volume_id= ? and B.status='QA' and CC.child_id is null and (teams_id=? or teams_id is null and ? = 0)  ORDER BY rand()";
     String SEL_SAMPLE_BATCH = "SELECT count(*) FROM child C   inner join batch B on B.batch_id = C.batch_id   left join batchuser BU on BU.batch_id = B.batch_id   left join users U on U.users_id = BU.coder_id   left join childcoded CC on C.child_id=CC.child_id and CC.round=0 WHERE B.volume_id=  ?   and B.status='QA'    and U.teams_id=  ?   and CC.child_id is null GROUP BY U.teams_id";
     String INS_SAMPLE_CCODTOP = "INSERT INTO childcoded (child_id, status) SELECT TOP 1 C.child_id, 'QA' FROM child C    inner join batch B on B.batch_id = C.batch_id    left join batchuser BU on BU.batch_id = B.batch_id    left join users U on U.users_id = BU.coder_id   left join childcoded CC    on C.child_id=CC.child_id and CC.round=0 WHERE B.volume_id=? and B.status='QA'     and CC.child_id is null     and (teams_id = ? or teams_id is null and ? =0)   ORDER BY rand()";
     String SEL_SAMPLE_CHILD = "SELECT count(*) FROM child C   inner join batch B on B.batch_id = C.batch_id   left join batchuser BU on BU.batch_id = B.batch_id   left join childcoded CC   on C.child_id=CC.child_id and CC.round=0 where B.volume_id=  ?   and B.status='QA'    and BU.coder_id=?";
     String INS_SAMPLE_CHILDID = "INSERT INTO childcoded (child_id, status) SELECT TOP ? C.child_id, 'QA' FROM child C   inner join batch B on B.batch_id = C.batch_id   left join batchuser BU on BU.batch_id = B.batch_id   left join childcoded CC   on C.child_id=CC.child_id and CC.round=0 WHERE B.volume_id= ? and B.status='QA' and CC.child_id is null  and BU.coder_id= ? ORDER BY rand()";
     String SEL_SQL_ROLE = "select role, text from sql_text where name=? order by sequence";
     String SEL_UPD_ROLE = "SELECT role, text FROM sql_text with(UPDLOCK) WHERE name= ?";
     String SEL_TSPEC_PROJID = "SELECT project_id  FROM project  WHERE project_id =? and active = 1";
     String SEL_TSPEC_TBNAME = "SELECT TS.table_name, PF.projectfields_id  FROM tablespec TS, projectfields PF  WHERE TS.tablespec_id = ? and TS.tablespec_id = PF.tablespec_id";
     String DEL_TSPEC_TSPEC = "DELETE FROM tablespec WHERE tablespec_id =?";
     String DEL_TSPEC_TVALUE = "DELETE from tablevalue WHERE tablespec_id =?";
     String UPD_TSPEC_TBNAME = "UPDATE tablespec  SET table_name =? ,table_type = ?, project_id =? ,requirement =? , updateable =? ,model_tablespec_id = ? WHERE tablespec_id =?";
     String SEL_TSPEC_TSPEC = "SELECT * FROM tablespec  WHERE table_name = ''";
     String INS_TSPEC_TSPEC = "INSERT INTO tablespec(table_name, table_type, project_id, requirement,updateable,model_tablespec_id) VALUES (?,?,?,?,?,?)";
     String INS_TBVALUE_TBVAL = "INSERT INTO tablevalue (tablespec_id, value, field_level, model_value) VALUES (?,?,?,?)";
     String UPD_TBVALUE_TBVAL = "UPDATE tablevalue  SET value = ?, field_level = ?, model_value = ?  WHERE tablespec_id = ? and value = ?";
     String SEL_TBVALUE_TBTYPE = "SELECT table_type  FROM tablespec WHERE tablespec_id = ?";
     String DEL_TBVALUE_TBVAL = "DELETE FROM tablevalue WHERE tablespec_id = ? and value =?";
     String UPD_TEAMS_TEAMID = "UPDATE teams  SET teams_id = ? ,users_id = ?, team_name = ?  WHERE teams_id = ?";
     String SEL_TEAMS_USERS = "SELECT 0 as '0' FROM users  WHERE teams_id =  and active =1";
     String DEL_TEAMS_TEAMID = "DELETE FROM teams WHERE teams_id =";
     String INS_TEAMS_USERID = "INSERT INTO teams (users_id, team_name)  VALUES (?,?)";
     String SEL_TEAMS_TOP = "SELECT TOP 1 teams_id FROM teams ORDER BY teams_id DESC";
     String SEL_TEAMS_TEAMSID = "SELECT teams_id  FROM users  WHERE users_id = ?";
     String UPD_TEAMS_USERS = "UPDATE users  SET teams_id = ? WHERE users_id = ?";
     String SEL_TEAMS_TNAME = "SELECT 0 FROM teams WHERE team_name=? and teams_id <> ?";
     String DEL_TVOL_VTID = "DELETE FROM teamsvolume   WHERE volume_id=? and teams_id=?";
     String DEL_TVOL_VID = "DELETE FROM teamsvolume WHERE volume_id=";
     String DEL_TVOL_TQUEUE = "DELETE FROM teamsqueue  WHERE batch_id=?";
     String DEL_TVOL_UQUEUE = "DELETE FROM usersqueue WHERE batch_id=?";
     String SEL_TVOL_BATCHID = "SELECT batch_id  FROM batch WHERE volume_id=";
     String SEL_TERMINATE_USERID = "SELECT users_id FROM session  WHERE session_id=";
     String DEL_TERMINATE_SESSION = "DELETE FROM session  WHERE session_id=";
     String UPD_UPRICE_UPRCIE = "UPDATE unitprice  SET  unitize_page_price=?, unitize_doc_price=?, uqc_page_price=?, uqc_doc_price=?,coding_page_price=?, coding_doc_price=?,codingqc_page_price=?, codingqc_doc_price= ? WHERE unitprice_id =?";
     String INS_UPRICE_PID = "INSERT INTO unitprice    (project_id, volume_id, field_level, unitize_page_price, unitize_doc_price      , uqc_page_price, uqc_doc_price      , coding_page_price, coding_doc_price      , codingqc_page_price, codingqc_doc_price) VALUES (?,?,?,?,?,?,?,?,?,?,?)";
     String SEL_UPDVAL_CID = "SELECT C.child_id FROM tablespec TS  inner join volume V on V.project_id = TS.project_id inner join child C ON (C.volume_id = V.volume_id)  inner join projectfields PF ON (PF.project_id = V.project_id and PF.tablespec_id = TS.tablespec_id)     inner join value NVa ON (NVa.child_id = C.child_id  and NVa.field_name = PF.field_name) WHERE TS.tablespec_id = ? and TS.project_id in (0,?)     and NVa.value =?";
     String SEL_UPDVAL_CHILDID = "SELECT C.child_id FROM tablespec TS  inner join volume V on V.project_id = TS.project_id  inner join child C ON (C.volume_id = V.volume_id)  inner join projectfields PF ON (PF.project_id = V.project_id and PF.tablespec_id = TS.tablespec_id)  inner join namevalue NVa ON (NVa.child_id = C.child_id  and NVa.field_name = PF.field_name) WHERE TS.tablespec_id = ?   and TS.project_id in (0,? )    and NVa.first_name = ?    and NVa.middle_name =  ?   and NVa.last_name = ?  and NVa.organization =?";
     String DEL_UPDVAL_CHILDID = "DELETE FROM value WHERE child_id = ? and value =?";
     String DEL_UPDVAL_NAMEVALUE = "DELETE FROM namevalue WHERE child_id = ? and first_name =  ?  and middle_name = ? and last_name =  ?  and organization =?";
     String UPD_UPDVAL_VAL = "UPDATE value SET value = ? WHERE child_id = ?    and value =?";
     String UPD_UPDVAL_NAMEVALUE = "UPDATE namevalue SET first_name = ?,middle_name = ?,last_name = ?,organization = ?,value = ? WHERE child_id = ?and first_name = ? and middle_name = ? and last_name = ? and organization = ? and value =?";
     String SEL_USERS_UID = " SELECT users_id FROM users WHERE user_name = ? and active = 1";
     String SEL_USERS_TEAMSID = "SELECT teams_id FROM users WHERE users_id =";
     String UPD_USERS_TID = "UPDATE users SET teams_id = ?,user_name = ?, first_name = ?,last_name = ? , unitize = ?,uqc = ? , coding = ?, codingqc = ?,qa = ?,listing = ?,team_leader = ?,admin = ?,admin_users = ?, admin_project = ?,admin_batch = ?,admin_edit = ? ,admin_import = ?, admin_export = ?, admin_profit = ?,password = ? CASE WHEN password=? THEN password     ELSE 123   END   WHERE users_id =?";
     String SEL_USERS_ASSIGN = "SELECT 0 as '0' FROM assignment  WHERE users_id= ? UNION ALL SELECT 0 as '0' FROM usersqueue WHERE users_id= ? UNION ALL SELECT 0 as '0' FROM session WHERE users_id=?";
     String UPD_USERS_TEAMID = "UPDATE users    SET teams_id = 0,        active = 0,        unitize = 'No',        uqc = 'No', coding = 'No', codingqc = 'No',qa = 'No', listing = 'No',tally = 'No', team_leader = 'No', admin = 'No',admin_users = 'No', admin_project = 'No', admin_batch = 'No',admin_edit = 'No', admin_import = 'No', admin_export = 'No',admin_profit = 'No',password = '' WHERE users_id = ?";
     String INS_USERS_USERS = "INSERT INTO users(active,teams_id,user_name,first_name,last_name,unitize,uqc,coding,codingqc,qa,listing, tally, team_leader,admin,admin_users,admin_project,admin_batch,admin_edit,admin_import,admin_export,admin_profit,password,DOJ)   VALUES(1,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
     String SEL_USERS_TOP1 = "SELECT TOP 1 users_id FROM users ORDER BY users_id DESC";
     String SEL_USERS_UNAME = "SELECT TOP 1 0 as remove FROM users WHERE user_name= ? and users_id <> ? and active = 1";
     String SEL_USERS_USRID = "SELECT users_id FROM teams WHERE teams_id = ";
     String UPD_USERS_TEAMS = "UPDATE teams SET users_id = ?  WHERE teams_id =?";    
     String SEL_MSHALL_VID = "SELECT V.volume_id, B.batch_id FROM volume V0   inner join volume V on V.project_id = V0.project_id   inner join batch B on B.volume_id = V.volume_id WHERE V0.volume_id=? and V.sequence=-1";
     String SEL_MSHALL_PID = "Declare @delta as int If(@delta > 0)  SELECT P.page_id   FROM page P, batch B   WHERE B.batch_id=1      and P.volume_id = B.volume_id      and P.seq between B.lft and B.rgt      and P.seq =      (SELECT TOP 1 seq      FROM (SELECT TOP (@delta-1) seq FROM page     ORDER BY seq DESC) as TOPN(seq)      ORDER BY seq ASC)  ORDER BY P.seq  If Not(@delta > 0)  SELECT P.page_id   FROM page P, batch B   WHERE B.batch_id=1      and P.volume_id = B.volume_id      and P.seq between B.lft and B.rgt      and P.seq =          (SELECT TOP 1 seq      FROM (SELECT TOP (-@delta-1) seq FROM page     ORDER BY seq desc) as TOPN(seq)      ORDER BY seq ASC)      ORDER BY P.seq desc";
     String SEL_MSHALL_PAGEID = "Declare @delta as int If(@delta > 0) SELECT P.page_id FROM page P  inner join child C on P.volume_id=C.volume_id and P.seq=C.lft          , batch B  WHERE B.batch_id= 1      and C.volume_id = B.volume_id     and C.lft between B.lft and B.rgt     and C.lft =   (SELECT TOP 1 lft      FROM (SELECT TOP (@delta-1) lft FROM child     ORDER BY lft DESC) as TOPN(lft)      ORDER BY lft ASC)   ORDER BY C.lft    If Not(@delta > 0)  SELECT P.page_id   FROM page P   inner join child C on P.volume_id=C.volume_id and P.seq=C.lft          , batch B  WHERE B.batch_id= 1      and C.volume_id = B.volume_id     and C.lft between B.lft and B.rgt     and C.lft =   (SELECT TOP 1 lft      FROM (SELECT TOP (-@delta-1) lft FROM child     ORDER BY lft DESC) as TOPN(lft)      ORDER BY lft ASC)   ORDER By C.lft desc";
     String SEL_MSHALL_PSEQ = "SELECT P.seq FROM batchuser BU   inner join page P   on P.page_id=BU.last_unitized_page_id WHERE BU.batch_id=";
     String SEL_MSHALL_TOPPID = "SELECT TOP 1 page_id FROM page P   inner join batch B   on P.volume_id=B.volume_id   and P.seq between B.lft and B.rgt WHERE P.seq > ? and B.batch_id=? order by seq";
     String SEL_MSHALL_TOPPGID = "SELECT TOP 1 P.page_id FROM child C, batch B, page P  left join childcoded CC  on P.child_id =  CC.child_id  and CC.round = 0 WHERE B.batch_id = ?   and C.volume_id = B.volume_id   and C.lft between B.lft and B.rgt   and P.volume_id = C.volume_id   and P.seq = C.lft   and CC.child_id is null ORDER BY C.lft";
     String SEL_MSHALL_PAGE = "SELECT page_id FROM page P WHERE page_id=";    
     String SEL_MSHALL_CHILD = " SELECT page_id FROM page P   inner join child C on C.child_id = P.child_id WHERE P.page_id= ? and C.batch_id=?";
     String SEL_MSHALL_DECPGID = "Declare @delta as int If(@delta > 0) SELECT P2.page_id FROM page P, page P2, batch B WHERE P2.volume_id = P.volume_id       and P2.seq > P.seq       and P.page_id=        and B.batch_id=     and P2.seq between B.lft and B.rgt       and P2.seq =          (SELECT TOP 1 seq     FROM (SELECT TOP (@delta-1) seq FROM page    ORDER BY seq DESC) as TOPN(seq)     ORDER BY seq ASC) ORDER BY P2.seq  If Not(@delta > 0) SELECT P2.page_id FROM page P, page P2, batch B WHERE P2.volume_id = P.volume_id    and P2.seq < P.seq    and P.page_id=     and B.batch_id=     and P2.seq between B.lft and B.rgt    and P2.seq = (SELECT TOP 1 seq     FROM (SELECT TOP (-@delta-1) seq FROM page    ORDER BY seq DESC) as TOPN(seq)     ORDER BY seq ASC) ORDER BY P2.seq desc";
     String SEL_MSHALL_DECPAGEID = "Declare @delta as int If(@delta > 0) SELECT P2.page_id FROM page P, child C, batch B, page P2 WHERE C.volume_id = P.volume_id  and C.rgt >= P.seq  and P.page_id= +pageId+  and B.batch_id=+batchId+  and C.rgt between B.lft and B.rgt  and P2.volume_id=C.volume_id and P2.seq=C.lft  and C.rgt =     (SELECT TOP 1 rgt      FROM (SELECT TOP (@delta-1) rgt FROM child     ORDER BY rgt DESC) as TOPN(rgt)      ORDER BY rgt ASC)  ORDER BY C.rgt If Not(@delta>0) SELECT P2.page_id FROM page P, child C, batch B, page P2 WHERE C.volume_id = P.volume_id   and C.lft <= P.seq   and P.page_id=+pageId+   and B.batch_id=+batchId+   and C.rgt between B.lft and B.rgt   and P2.volume_id=C.volume_id   and P2.seq=C.lft   and C.lft =         (SELECT TOP 1 lft          FROM (SELECT TOP (-@delta-1) lft FROM child         ORDER BY lft DESC) as TOPN(lft)          ORDER BY lft ASC)  ORDER BY C.lft desc";
     String SEL_MSHALL_BATES = "SELECT page_id FROM page WHERE volume_id=   and bates_number=";
     String SEL_MSHALL_SEQ = "SELECT P.seq, B.batch_id, P.bates_number       , sum(case when (P2.seq <= P.seq) then 1 else 0 end) as 'sum(P2.seq <= P.seq)'), count(*)       , V.lft, V.rgt, B.lft, B.rgt       , R.lft, R.rgt, C.lft, C.rgt       , P.boundary_flag, P.path, P.filename, P.child_id       , V.volume_id, V.volume_name, V.image_path       , P.offset, P.group_one_path, P.group_one_filename       , P.document_number FROM page P      inner join child C on C.child_id = P.child_id      inner join range R on R.range_id = C.range_id      inner join batch B on C.batch_id=B.batch_id      inner join volume V on V.volume_id = C.volume_id      inner join page P2 on P2.child_id = C.child_id WHERE P.page_id =? and P2.seq <= P.seq GROUP BY P.page_id,P.seq,B.batch_id, P.bates_number,V.lft,V.rgt,B.lft,B.rgt,R.lft,          R.rgt,C.lft,C.rgt,P.boundary_flag,P.path,P.filename,P.child_id,V.volume_id,          V.volume_name,V.image_path,P.offset,P.group_one_path,P.group_one_filename       , P.document_number";
     String SEL_MSHALL_CHILDC = "SELECT P.page_id FROM child C inner join page P  on C.volume_id=P.volume_id and C.lft=P.seq WHERE C.child_id=";
     String SEL_MSHALL_BNO = "SELECT P.seq, B.batch_id, P.bates_number, sum(P2.seq), count(*), V.lft, V.rgt, B.lft, B.rgt       , R.lft, R.rgt, C.lft, C.rgt       , P.boundary_flag, P.path, P.filename, P.child_id       , V.volume_id, V.volume_name, V.image_path       , P.offset, P.group_one_path, P.group_one_filename       , P.document_number FROM page P      inner join child C on C.child_id = P.child_id      inner join range R on R.range_id = C.range_id      inner join batch B on C.batch_id=B.batch_id      inner join volume V on V.volume_id = C.volume_id      inner join page P2 on P2.child_id = C.child_id WHERE P.page_id = ? and P2.seq <= P.seq GROUP BY P.page_id,P.seq,B.batch_id, P.bates_number,V.lft,V.rgt,B.lft,B.rgt,R.lft,          R.rgt,C.lft,C.rgt,P.boundary_flag,P.path,P.filename,P.child_id,V.volume_id,          V.volume_name,V.image_path,P.offset,P.group_one_path,P.group_one_filename       , P.document_number";
     String SEL_MSHALL_SLFT = "select sum(lft <= ?, count(*) from child where volume_id=? and lft between ? and ?";
     String SEL_MSHALL_BATCHID = "SELECT P.seq, B.batch_id, P.bates_number, sum(case when (P2.seq <= P.seq) then 1 else 0 end) as 'sum(P2.seq <= P.seq)', count(*), V.lft, V.rgt,  B.lft, B.rgt    , R.lft, R.rgt, C.lft, C.rgt, P.boundary_flag, P.path,  P.filename, P.child_id    , V.volume_id, V.volume_name, V.image_path, P.offset,  FCP.bates_number, LCP.bates_number    , FRP.bates_number, LRP.bates_number,  B.batch_number, C.is_split    , P.group_one_path, P.group_one_filename , P.document_number, B.active_group  FROM page P inner join child C on C.child_id = P.child_id  inner join range R on R.range_id = C.range_id inner join batch B on C.batch_id=B.batch_id  inner join volume V on V.volume_id = B.volume_id inner join page FCP on FCP.volume_id=C.volume_id and FCP.seq=C.lft inner join page LCP on LCP.volume_id=C.volume_id and LCP.seq=C.rgt  inner join page FRP on FRP.volume_id=R.volume_id and FRP.seq=R.lft inner join page LRP on LRP.volume_id=R.volume_id and LRP.seq=R.rgt inner join page P2 on P2.child_id = C.child_id WHERE P.page_id=? GROUP BY P.page_id,P.seq,B.batch_id, P.bates_number,V.lft, V.rgt, B.lft, B.rgt, R.lft, R.rgt, C.lft, C.rgt,P.boundary_flag, P.path, P.filename, P.child_id,V.volume_id, V.volume_name, V.image_path, P.offset,FCP.bates_number, LCP.bates_number,FRP.bates_number, LRP.bates_number, B.batch_number, C.is_split,P.group_one_path, P.group_one_filename, P.document_number, B.active_group";
     String SEL_MSHALL_LFT = "SELECT sum(lft), count(*) FROM child WHERE volume_id = ? and lft <= ?   and lft between ? and ?";
     String SEL_MSHALL_FNAME = "SELECT field_name, codererror FROM fieldchange WHERE child_id=";
     String SEL_MSHALLQA_PID = "SELECT P.page_id FROM page P inner join child C on P.volume_id=C.volume_id and P.seq=C.lft    inner join childcoded CC using (child_id) WHERE C.volume_id =    and CC.round = 0    and CC.status='QA' ORDER BY C.lft limit ,1  :  ORDER BY C.rgt desc limit ,1";
     String SEL_MSHALLQA_PGID = "SELECT TOP 1 P.page_id FROM page P  inner join child C on P.volume_id=C.volume_id and P.seq=C.lft  inner join childcoded CC on CC.child_id = C.child_id WHERE C.volume_id = ?    and CC.round = 0     and CC.status='QA'     and CC.users_id = 0 ORDER BY C.lft";
     String SEL_MSHALLQA_PAGEID = "SELECT page_id FROM page P   inner join childcoded CC on CC.child_id = P.child_id WHERE P.page_id = ?    and CC.round = 0   and CC.status='QA'";
     String SEL_MSHALLQA_DECPID = "Declare @delta as int If(@delta > 0) SELECT P2.page_id FROM page P, page P2 inner join childcoded CC on P2.child_id = CC.child_id where P2.volume_id = P.volume_id  and P2.seq > P.seq  and P.page_id= +page_id     and CC.round = 0     and CC.status='QA'     and P2.seq =    (SELECT TOP 1 seq    FROM (SELECT TOP (@delta-1) seq FROM page   ORDER BY seq DESC) as TOPN(seq)    ORDER BY seq ASC) ORDER BY P2.seq If Not(@delta>0) SELECT P2.page_id FROM page P, page P2 inner join childcoded CC on P2.child_id = CC.child_id where P2.volume_id = P.volume_id         and P2.seq < P.seq         and P.page_id= +page_id         and CC.round = 0         and CC.status='QA'         and  P2.seq =             (SELECT TOP 1 seq        FROM (SELECT TOP (-@delta-1) seq FROM page       ORDER BY seq DESC) as TOPN(seq)        ORDER BY seq ASC) ORDER BY P2.seq desc";
     String SEL_MSHALLQA_DECPAGE = "Declare @delta as int If(@delta > 0) SELECT P2.page_id FROM page P, child C, page P2  inner join childcoded CC on P2.child_id = CC.child_id WHERE C.volume_id = P.volume_id      and C.lft > P.seq and P.page_id=+pageId+      and P2.volume_id=C.volume_id and P2.seq=C.lft      and CC.round = 0 and CC.status='QA'      and CC.users_id = 0            and C.rgt =              (SELECT TOP 1 rgt            FROM (SELECT TOP (@delta-1) rgt FROM child            ORDER BY rgt DESC) as TOPN(rgt)             ORDER BY rgt ASC)   order by C.rgt     If Not(@delta>0)   SELECT P2.page_id   FROM page P, child C, page P2     inner join childcoded CC on P2.child_id = CC.child_id   WHERE C.volume_id = P.volume_id         and C.lft <= P.seq and P.page_id= +pageId+         and P2.volume_id=C.volume_id and P2.seq=C.lft         and CC.round = 0 and CC.status='QA'         and CC.users_id = 0           and  C.rgt =            (SELECT TOP 1 rgt            FROM (SELECT TOP (-@delta-1) rgt FROM child            ORDER BY rgt DESC) as TOPN(rgt)             ORDER BY rgt ASC)    ORDER by C.lft desc";
     String SEL_MSHALLQA_VID = "SELECT page_id FROM page WHERE volume_id= ?  and bates_number=?";
     String SEL_MSHALLQA_CHILD = "SELECT P.page_id FROM child C inner join page P    on C.volume_id=P.volume_id and C.lft=P.seq WHERE C.child_id=";
     String SEL_MSHALLQA_PSEQ = "SELECT P.seq, 0, P.bates_number          ,sum(P2.seq),count(*)   , V.lft, V.rgt, 0, 1999999999        , R.lft, R.rgt, C.lft, C.rgt   , P.boundary_flag, P.path, P.filename, P.child_id   , V.volume_id, V.volume_name, V.image_path   , P.offset, P.group_one_path, P.group_one_filename   , P.document_number ,V.image_server FROM page P   inner join child C on C.child_id = P.child_id   inner join range R on R.range_id = C.range_id   inner join volume V on V.volume_id = R.volume_id   inner join page P2 on P2.child_id = C.child_id WHERE P.page_id= ? and P2.seq <= P.seq GROUP BY P.page_id,P.seq,P.bates_number, V.lft, V.rgt,          R.lft, R.rgt,C.lft,C.rgt,P.boundary_flag,P.path,          P.filename,P.child_id,V.volume_id,V.volume_name,    V.image_path,P.offset, P.group_one_path, P.group_one_filename,          P.document_number";
     String SEL_MSHALLQA_BATNO = "SELECT P.seq, 0, P.bates_number          , sum(case when (P2.seq <= P.seq) then 1 else 0 end), count(*)  , V.lft, V.rgt, 0, 1999999999       , R.lft, R.rgt, C.lft, C.rgt  , P.boundary_flag, P.path, P.filename, P.child_id  , V.volume_id, V.volume_name, V.image_path  , P.offset  , FCP.bates_number, LCP.bates_number  , FRP.bates_number, LRP.bates_number  , 0                                 , C.is_split  , P.group_one_path, P.group_one_filename  , P.document_number, B.active_group FROM page P    inner join child C on C.child_id = P.child_id    inner join range R on R.range_id = C.range_id    inner join batch B on C.batch_id=B.batch_id    inner join volume V on V.volume_id = B.batch_id    inner join page FCP on FCP.volume_id=C.volume_id      and FCP.seq=C.lft    inner join page LCP on LCP.volume_id=C.volume_id      and LCP.seq=C.rgt    inner join page FRP on FRP.volume_id=R.volume_id      and FRP.seq=R.lft    inner join page LRP on LRP.volume_id=R.volume_id       and LRP.seq=R.rgt    inner join page P2 on P2.child_id = C.child_id WHERE P.page_id= 1    and P2.seq <= P.seq GROUP BY P.page_id,P.seq,P.bates_number, V.lft, V.rgt,        R.lft, R.rgt, C.lft, C.rgt,P.boundary_flag, P.path,          P.filename, P.child_id, V.volume_id, V.volume_name, V.image_path          , P.offset,FCP.bates_number, LCP.bates_number    , FRP.bates_number, LRP.bates_number,C.is_split    , P.group_one_path, P.group_one_filename    , P.document_number, B.active_group";
     String SEL_MSHALLQA_LFT = "SELECT sum(lft) , count(*) as 'count(*)', min(lft) as 'min(lft)' , max(rgt) as 'max(rgt)' FROM child C   inner join childcoded CC on CC.child_id = C.child_id WHERE volume_id= ?   and lft<=   and CC.status = 'QA'   and CC.round = 0";
     String SEL_PMAP_PID = "SELECT F.project_id,   sequence,   field_name,   field_type,   field_size,   minimum_size,   repeated,   required,   default_value,   min_value,   max_value,   tablespec_id,   table_mandatory,   mask,   valid_chars,   invalid_chars,   charset,   type_field,   type_value,   unitize,   spell_check,   field_level,    CASE WHEN field_name = level_field_name   THEN 'Yes'   Else 'No'    END,     field_group  FROM projectfields F      inner join project P on P.project_id = F.project_id  WHERE P.project_id=?  order by sequence";
     String SEL_PMAP_VALUE = "select v.value from tablespec s, tablevalue v where s.tablespec_id=\'?\' and s.tablespec_id=v.tablespec_id order by v.value";
     String SEL_VMAP_PID = "select project_id from volume where volume_id = ";
     String SEL_VMAP_BATID = "select batch_id from child where child_id = ";
     String SEL_VMAP_EVENT = "select event,codinghistory_id from codinghistory where child_id = ? and field_name=?";
     String UPD_VMAP_CODHIST = "update codinghistory set value = ?  , logged_time = ? where codinghistory_id =? ";
     String INS_VMAP_CODHIST = "insert into codinghistory(child_id,project_id,volume_id,batch_id,field_name,field_type,value,event,user_id,logged_time) values(?,?,?,?,?,?,?,?,?,?)";
     String SEL_VMAP_FNAME = "SELECT field_name, value FROM namevalue WHERE child_id= ?  ORDER BY field_name, sequence";
     String SEL_VMAP_LNAME = "SELECT field_name, last_name, first_name, middle_name, organization FROM namevalue WHERE child_id= ? ORDER BY field_name, sequence";
     String SEL_VMAP_FTYPE = "SELECT field_type, field_size, minimum_size, repeated,queryraised,queryanswered,l1_information FROM projectfields F,volume V WHERE volume_id = ?  and V.project_id = F.project_id     and field_name =  ?";
     String DEL_VMAP_VALUE = "DELETE FROM value WHERE child_id = ?    and field_name = ?";
     String INS_VMAP_VALUE = "INSERT INTO value    (child_id, field_name, sequence, value) VALUES (?,?,?,?)";
     String DEL_VMAP_NVALUE = "DELETE FROM namevalue WHERE child_id = ?    and field_name = ?";
     String INS_VMAP_CHILDID = "INSERT INTO namevalue  (child_id, field_name, sequence, last_name, first_name, middle_name, organization, value) VALUES (?,?,?,?,?,?,?,?)";
     String SEL_VMAP_CHILD = "SELECT 0  FROM child WHERE volume_id=  ? and child_id = ?";
     String UPD_VMAP_FCHANGE = "UPDATE fieldchange  SET child_id=  ?, field_name = ?, codererror = ?";
     String DEL_VMAP_FCHANGE = "DELETE FC FROM fieldchange FC,child C WHERE C.child_id=? and C.volume_id=? and C.child_id = FC.child_id";
     String SEL_PWRITER_PID = "SELECT V.project_id,F.sequence,field_name,F.project_id,field_type,field_size,minimum_size,repeated,required,unitize,spell_check,default_value,min_value,max_value,tablespec_id,table_mandatory,mask,valid_chars,invalid_chars,charset,type_field,type_value,field_level, CASE WHEN (field_name = P.level_field_name) THEN 'Yes'    ELSE 'No'     END as 'is_level_field', field_group  FROM projectfields F    inner join project P on P.project_id = F.project_id    inner join volume V on V.project_id = P.project_id WHERE V.volume_id = ?  ORDER BY F.field_group, F.sequence";
     String SEL_DWRITER_FNAME = "SELECT field_name  FROM projectfields WHERE project_id = ? and tag_name = ?";
     String SEL_DWRITER_CHILDID = "SELECT child_id  FROM page WHERE volume_id =  ? and bates_number = ?";
     String DEL_DWRITER_VALUE = "DELETE FROM value   WHERE child_id = ? and field_name = ?";
     String DEL_DWRITER_LVDALUE = "DELETE FROM longvalue   WHERE child_id =  ? and field_name =?";
     String DEL_DWRITER_NVALUE = "DELETE FROM namevalue WHERE child_id =  ? and field_name = ?";
     String INS_DWRITER_NVALUE = "INSERT INTO namevalue  (child_id, field_name, sequence, value)   values (?,?,?,?)";
     String SEL_DWRITER_AGE = "SELECT age  FROM svrage  with(UPDLOCK) WHERE dummy_key = 0";
     String UPD_DWRITER_AGE = "update svrage set age=? where dummy_key = 0";
     String SEL_DWRITER_VID = "SELECT volume_id, project_id  FROM volume WHERE volume_name = ?";
     String SEL_DWRITER_SESSION = "SELECT 0 FROM session WITH(HOLDLOCK) WHERE volume_id = ?";
     String SEL_DWRITER_TVOL = "SELECT 0  FROM teamsvolume (HOLDLOCK) WHERE volume_id =  ?";
     String SEL_DWRITER_TQUEUE = "SELECT 0  FROM teamsqueue TQ WITH(UPDLOCK)  inner join batch B on B.batch_id = TQ.batch_id WHERE B.volume_id = ?";
     String SEL_DWRITER_UQUEUE = "SELECT 0  FROM usersqueue UQ WITH(HOLDLOCK)  inner join batch B on B.batch_id = UQ.batch_id where B.volume_id = ?";
     String SEL_DWRITER_ASSIGN = "SELECT 0  FROM assignment A WITH(HOLDLOCK)  inner join batch B on B.batch_id = A.batch_id where B.volume_id = ?";
     String SEL_DWRITER_FIELDNAME = "select field_name from projectfields PF  inner join project P on (P.project_id = PF.project_id and project_name = ?) order by sequence";
     String SEL_DWRITER_FTYPE = "SELECT field_name, field_type  FROM projectfields PF    inner join project P on (P.project_id = PF.project_id) and project_name = ?";
     String INS_DWRITER_NAMEVALUE = "INSERT INTO namevalue (child_id, field_name, sequence, last_name,  first_name, middle_name, organization, value) VALUES (?,?,?,?,?,?,?,?)";
     String SEL_DBWRITER_AGE = "SELECT age  FROM svrage WITH(UPDLOCK) WHERE dummy_key = 0";
     String UPD_DBWRITER_AGE = "UPDATE svrage  SET age= ? WHERE dummy_key = 0";
     String SEL_DBWRITER_PID = "SELECT project_id, active  FROM project WITH(HOLDLOCK) WHERE project_name = ?  ORDER BY active desc";
     String UPD_DBWRITER_PROJ = "UPDATE project SET split_documents=0 WHERE project_id=";
     String SEL_DBWRITER_PROJID = "SELECT project_id, volume_id  FROM volume WITH(HOLDLOCK) WHERE volume_name = ?";
     String SEL_DBWRITER_SESSION = "SELECT 0  FROM session WITH(HOLDLOCK) WHERE volume_id =";
     String SEL_DBWRITER_TVOL = "SELECT 0  FROM teamsvolume WITH(HOLDLOCK) WHERE volume_id =";
     String SEL_DBWRITER_TQ = "SELECT 0  FROM teamsqueue TQ WITH(HOLDLOCK) inner join batch B on B.batch_id = TQ.batch_id where B.volume_id =";
     String SEL_DBWRITER_UQ = " SELECT 0  FROM usersqueue UQ WITH(HOLDLOCK)  inner join batch B on B.batch_id = UQ.batch_id where B.volume_id =";
     String SEL_DBWRITER_ASSIGN = "SELECT 0  FROM assignment A WITH(HOLDLOCK) inner join batch B on B.batch_id = A.batch_id where B.volume_id =";
     String SEL_DBWRITER_TOP = "SELECT TOP 1 Va.child_id, NV.child_id, LV.child_id  FROM volume V, child C  left join value Va on (Va.child_id = C.child_id)  left join namevalue NV on (NV.child_id = C.child_id)  left join longvalue LV on (LV.child_id = C.child_id) WHERE V.volume_id = C.volume_id AND Va.field_name != 'General Document Type' AND V.volume_id= ";
     String DEL_DBWRITER_VOL = "DELETE FROM volume WHERE volume_id=";
     String SEL_DBWRTITER_UPID = "SELECT unitprice_id  FROM unitprice WHERE volume_id=";
     String DEL_DBWRTITER_UPRICE = "DELETE FROM unitprice WHERE volume_id=";
     String SEL_DBWRTITER_CPID = "SELECT customerprice_id  FROM customerprice WHERE volume_id=";
     String DEL_DBWRTITER_CP = "DELETE FROM customerprice WHERE volume_id=";
     String DEL_DBWRTITER__BATCH = "DELETE FROM batch WHERE volume_id=";
     String DEL_DBWRTITER_RANGE = "DELETE FROM range WHERE volume_id=";
     String DEL_DBWRTITER_CHILD = "DELETE FROM child WHERE volume_id=";
     String DEL_DBWRTITER__PAGE = "DELETE FROM page WHERE volume_id=";
     String DEL_DBWRTITER__PGISSUE = "DELETE FROM pageissue WHERE volume_id=";
     String SEL_DBWRITER_RGT = "SELECT max(rgt) as 'max(rgt)' FROM project WITH(HOLDLOCK) WHERE project_id =";   
     String SEL_DBWRITER_HVOL = "SELECT high_volume  FROM project WITH(UPDLOCK) WHERE project_id=";
     String UPD_DBWRITER_HVOL = "UPDATE project SET high_volume=? WHERE project_id=?";
     String INS_DBWRITER_VOL = "INSERT INTO volume(volume_name,project_id,sequence,lft,rgt,image_path,original_volume_name,image_server,internal_volume_name,skip_unitize,vol_completed_date) VALUES(?,?,?,0,0,?,?,?,?,?,?)";    
     String INS_DBWRITER_UPRICE = "INSERT into unitprice (project_id, volume_id, field_level, unitize_page_price, unitize_doc_price    , uqc_page_price, uqc_doc_price    , coding_page_price, coding_doc_price    , codingqc_page_price, codingqc_doc_price)    SELECT DISTINCT P.project_id,  ?  AS vol, coalesce(PF.field_level, 0)     , UP.unitize_page_price, UP.unitize_doc_price     , UP.uqc_page_price, UP.uqc_doc_price     , UP.coding_page_price, UP.coding_doc_price     , UP.codingqc_page_price, UP.codingqc_doc_price    FROM project P      inner join projectfields PF on P.project_id = PF.project_id      left join unitprice UP ON UP.project_id = P.project_id       AND UP.volume_id = 0 AND UP.field_level = PF.field_level    WHERE P.project_id =? and P.active = 1    GROUP BY P.project_id, volume_id, coalesce(PF.field_level, 0)    , UP.unitize_page_price, UP.unitize_doc_price    , UP.uqc_page_price, UP.uqc_doc_price    , UP.coding_page_price, UP.coding_doc_price    , UP.codingqc_page_price, UP.codingqc_doc_price";
     String INS_DBWRITER_UP = "INSERT into unitprice (project_id, volume_id, field_level) VALUES (?,?,0)";
     String SEL_DBWRITER_UPRICEID = "SELECT unitprice_id  FROM unitprice WHERE volume_id=";
     String INS_DBWRITER_CPRICE = "INSERT into customerprice (project_id, volume_id, field_level   , unitize_page_price, unitize_doc_price   , coding_page_price, coding_doc_price)   SELECT DISTINCT P.project_id,  ? AS vol, coalesce(PF.field_level, 0)      , CP.unitize_page_price, CP.unitize_doc_price      , CP.coding_page_price, CP.coding_doc_price   FROM project P      inner join projectfields PF on P.project_id = PF.project_id      left join customerprice CP ON CP.project_id = P.project_id      AND CP.volume_id = 0 AND CP.field_level = PF.field_level    WHERE P.project_id = ? and P.active = 1    GROUP BY P.project_id, volume_id, coalesce(PF.field_level, 0),    CP.unitize_page_price, CP.unitize_doc_price,          CP.coding_page_price, CP.coding_doc_price";
     String INS_DBWRITER_CUSTPRICE = "INSERT into customerprice (project_id, volume_id, field_level) VALUES (?,?,0)";
     String SEL_DBWRITER_CID = "SELECT customerprice_id  FROM customerprice WHERE volume_id=";
     String SEL_DBWRITER_HUB = "SELECT high_unitize_batch  FROM project WITH(HOLDLOCK) WHERE project_id=";
     String INS_DBWRITER_BATCH = "INSERT INTO batch  (volume_id,lft,rgt,batch_number,status,priority,active_group) VALUES (?,?,?,?,'Unitize',0,?)";
     String INS_DBWRITER_PROJECT = "INSERT INTO project (active,project_name,level_field_name,high_coding_batch, high_unitize_batch,high_volume,lft,rgt,split_documents) VALUES(,,,,,,,,)";
     String SEL_DBWRITER_PRID = "SELECT TOP 1 project_id FROM project ORDER BY project_id DESC";
     String INS_DBWRITER_UNPRICE = "INSERT INTO unitprice (project_id,volume_id,field_level,unitize_page_price,unitize_doc_price,  uqc_page_price,uqc_doc_price,coding_page_price,coding_doc_price,codingqc_page_price,codingqc_doc_price) VALUES(?,0,0,0,0,0,0,0,0,0,0)";
     String INS_DBWRITER_CUSPRICE = "INSERT INTO customerprice (project_id,volume_id,field_level,unitize_page_price,unitize_doc_price,coding_page_price,coding_doc_price) VALUES(?,0,0,0,0,0,0)";
     String SEL_DBWRITER_CUSPRICE = "SELECT TOP 1 customerprice_id FROM customerprice ORDER BY customerprice_id DESC";
     String INS_DBWRITER_PAGE = "INSERT INTO page   (volume_id,seq,child_id,bates_number,original_flag,original_rotate,path,  filename,offset,file_type,boundary_flag,rotate,boundary,group_one_path,  group_one_filename,document_number) VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
     String INS_DBWRITER_RANGER = "INSERT INTO range (volume_id,lft,rgt) VALUES(?,?,0)";
     String SEL_DBWRITER_RANGEID = "SELECT TOP 1 range_id FROM range ORDER BY range_id DESC";
     String INS_DBWRITER_CHILD = "INSERT INTO child (volume_id,lft,rgt,range_id,batch_id) VALUES(?,?,0,?,?)";
     String SEL_DBWRITER_CHILDID = "SELECT TOP 1 child_id FROM child ORDER BY child_id DESC";
     String UPD_DBWRITER_PROJECT = "UPDATE project SET high_unitize_batch= ? WHERE project_id= ?";
     String SEL_DBWRITER_MAXRGT = "SELECT max(rgt), min(lft) FROM batch WHERE volume_id =";
     String UPD_DBWRITER_VOLUME = "UPDATE volume SET lft= ?, rgt = ? WHERE volume_id=?";
     String SEL_DBWRITER_MINLFT = "SELECT max(rgt), min(lft)  FROM volume WHERE project_id =";
     String UPD_DBWRITER_PROJLFT = "UPDATE project   SET lft=?, rgt=?  WHERE project_id=?";
     String UPD_DBWRITER_RGTBID = "UPDATE batch   SET rgt=? WHERE batch_id=?";
     String UPD_DBWRITER_RANGE = "UPDATE range SET rgt=? WHERE range_id=?";
     String UPD_DBWRITER_CHILD = "UPDATE child   SET rgt=? WHERE child_id= ?";
     String SEL_DBWRITER_MAXSEQ = "SELECT max(sequence) as 'max(sequence)' FROM pageissue WHERE page_id=";
     String INS_DBWRITER_PGISSUE = "INSERT INTO pageissue (page_id, volume_id, sequence,issue_name) VALUES(?,?,?,?)";
     String INS_DBWRITER_CHANGES = "INSERT INTO changes (table_nbr,id,age) VALUES(?,?,?)";
     String SEL_EDIT_CM = "SELECT project_id,project_name FROM project WHERE project_id =?";
     String SEL_DIA_CM = "SELECT coding_manual_id  FROM coding_manual  WHERE project_name = ?";
     String INS_DIA_CM = "INSERT INTO coding_manual  (project_name,codingManual_fileName,codingManual_filepath)  VALUES(?,?,?)";
     String UPD_DIA_CM = "UPDATE coding_manual  SET project_name = ?,codingManual_fileName = ?,codingManual_filepath = ?  WHERE project_name =?";
     String SEL_BATVAL_PID = "SELECT project_id FROM volume WHERE volume_id =?  and sequence > 0";
     String SEL_BATVAL_CHILDID = "SELECT C.child_id FROM batch B inner join child C on C.volume_id=B.volume_id and C.lft between B.lft and B.rgt WHERE B.batch_id= ? ORDER BY C.lft";
     String SEL_BATVAL_FIELDNAME = "SELECT field_name, value FROM value WHERE child_id=  ORDER BY field_name, sequence";
     String SEL_BATVAL_LNAME = "SELECT field_name,last_name, first_name, middle_name, organization FROM namevalue WHERE  child_id=  ORDER BY field_name, sequence";
     String SEL_BMAP_SEQ = "SELECT P.seq, C.child_id, C.lft, C.rgt, R.range_id, R.lft, R.rgt, C.batch_id, C.is_split FROM page P inner join child C on C.child_id = P.child_id inner join range R on R.range_id = C.range_id where P.page_id= ? and P.volume_id=?";
     String UPD_BMAP_BOUNDARY = "UPDATE page SET boundary= ?, boundary_flag=? WHERE page_id=?";
     String INS_BMAP_CHANGES = "INSERT INTO changes (table_nbr,id,age) VALUES(?,?,?)";
     String SEL_BMAP_RANGEID = "SELECT TOP 1 range_id, lft FROM range WHERE volume_id=? and rgt < ? ORDER BY rgt desc";
     String UPD_BMAP_RGT = "UPDATE range SET rgt=? WHERE range_id=?";
     String DEL_BMAP_RANGEID = "DELETE FROM range WHERE range_id=";
     String UPD_BMAP_CHILD = "UPDATE child   set range_id=? WHERE range_id=?";
     String SEL_BMAP_CHILDID = "SELECT TOP 1 child_id, lft FROM child WHERE volume_id=? and rgt < ?  ORDER BY rgt desc";
     String UPD_BMAP_CHILDRGT = "UPDATE child SET rgt=? WHERE child_id=?";
     String DEL_BMAP_CHILD = "DELETE FROM child WHERE child_id=";
     String UPD_BMAP_CID = "UPDATE page SET child_id=? WHERE child_id=?";
     String DEL_BMAP_CHILDID = "DELETE FROM value WHERE child_id=";
     String DEL_BMAP_LVAL = "DELETE FROM longvalue WHERE child_id=";
     String DEL_BMAP_NVAL = "DELETE FROM namevalue WHERE child_id=";
     String SEL_BMAP_TOPSEQ = "SELECT TOP 1 P.seq FROM page P WHERE P.volume_id= ? and P.seq < ? ORDER BY P.seq desc";
     String UPD_BMAP_RGTCHID = "UPDATE child SET rgt=? WHERE child_id=?";
     String INS_BMAP_CHILD = "INSERT INTO child (volume_id,lft, rgt,range_id,batch_id) VALUES(?,?,?,?,?)";
     String UPD_BMAP_CHIDSEL = "UPDATE page SET child_id= (SELECT TOP 1 child_id FROM child ORDER BY child_id DESC) WHERE child_id=? and seq >=?";
     String SEL_BMAP_SEQPAGE = "SELECT TOP 1 P.seq FROM page P WHERE P.volume_id=? and P.seq < ? order by P.seq desc";
     String UPD_BMAP_RANGE = "UPDATE range SET rgt=? WHERE range_id=?";
     String INS_BMAP_RANGE = "INSERT INTO range (volume_id,lft,rgt) VALUES(?,?,?)";
     String UPD_BMAP_RID = "UPDATE child SET range_id= (SELECT TOP 1 range_id FROM range ORDER BY range_id DESC) where range_id = ? and lft >=?";
     String SEL_ELOG_TSTAMP = "SELECT close_timestamp FROM event WHERE users_id=? and volume_id=? and batch_id=? and status= ? and close_timestamp = 0";
     String UPD_ELOG_TSTAMP = "UPDATE event SET close_timestamp=? WHERE users_id=? and volume_id=? and batch_id=? and status= ? and close_timestamp = 0";
     String INS_ELOG_UID = "INSERT INTO event (users_id,volume_id,batch_id,status,open_timestamp,add_timestamp,  close_timestamp,child_count,page_count,field_count) VALUES(?,?,?,?,0,0,0,?,?,?)";
     String UPD_ELOG_CLOSE = "UPDATE event SET close_timestamp=? WHERE users_id=? and volume_id=? and batch_id=? and status=? and close_timestamp = 0";
     String UPD_ELOG_EVENT = "UPDATE event SET child_count=child_count + 2, page_count=page_count + 2, field_count=field_count + 4, add_timestamp=?  WHERE users_id=? and volume_id=? and batch_id=? and status=? and close_timestamp = ?";
     String SEL_IMGSOURCE_IMAGE = "SELECT image  FROM binder_image WHERE page_id=";
     String SEL_MODEL_AGE = "SELECT age  FROM svrage  WHERE dummy_key = 0";
     String SEL_MODEL_NBR = "SELECT distinct table_nbr  FROM changes WHERE age >";
     String UPD_MODEL_SESSION = "UPDATE session  SET age=? WHERE session_id=?";
     String SEL_MODEL_ID = "SELECT distinct id  FROM changes WHERE table_nbr=? and age > ? ORDER BY id";
     String SEL_MODEL_TEXT = "SELECT text  FROM sql_text WHERE name ='";
     String INS_MANAGE_CHANGES = "INSERT INTO changes (table_nbr, id, age) SELECT +table.getTableNumber(), +tableName_id, FROM +tableName   WHERE +tableName_id >= (SELECT TOP 1 TablePK_id FROM TableName ORDER BY TablePK_id DESC)";
     String INS_MANAGE_TBLNBR = "INSERT INTO changes (table_nbr, id, age) SELECT +targetTable.getTableNumber(), X.+targetName_id,// age FROM changes C, +targetName X, +tableName T WHERE C.table_nbr=+table.getTableNumber() and C.id=T.+tableName_id and X.+idColumn=T.+idColumn and T.+tableName_id > (SELECT TOP 1 TablePK_id FROM TableName ORDER BY TablePK_id DESC)";
     String INS_MANAGE_ID = "Insert  into changes (table_nbr, id, age) select +table.getTableNumber(), +alias.+tableName_id,// agefrom +tableName+spaceAndAlias where";
     String INS_MANAGE_AGE = "Insert  into changes (table_nbr, id, age)  select +targetTable.getTableNumber(), X.+targetName_id, C.age  from changes C, +targetName X, +tableName T  where C.table_nbr=+table.getTableNumber() and C.id=T.+tableName_id and X.+idColumn=T.+idColumn and C.age=";
     String INS_MANAGE_TABNO = "insert  into changes (table_nbr, id, age) select +table.getTableNumber(), +tableName_id,// agefrom +tableName+joinedTableswhere";
     String INS_MANAGE_TARTBL = "insert  into changes (table_nbr, id, age) select +targetTable.getTableNumber(), X.+targetName_id, C.age from changes C, +targetName X, +tableName T where C.table_nbr=+table.getTableNumber() and C.id=T.+tableName_id and X.+idColumn=T.+idColumn and C.age=";
     String SEL_UTASK_SVRAGE = "SELECT age FROM svrage WITH(UPDLOCK) WHERE dummy_key = 0";
     String UPD_UTASK_SVRAGE = "UPDATE svrage  SET age = ? WHERE dummy_key = 0";
     String SEL_UTASK_SYSOBJECTS = "if exists (select * from dbo.sysobjects where id = object_id(N'[dbo].[#TEMP]') and OBJECTPROPERTY(id, N'IsUserTable') = 1) drop table [dbo].[#TEMP] GO";
     String UPD_UTASK_SESSION = "Update session SET volume_id = B.volume_id, batch_id=B.batch_id , lock_time= ? From session S, batch B where S.session_id= ? and B.batch_id=?";
     String UPD_UTASK_VID = "UPDATE session set volume_id= ?, lock_time= WHERE session_id=?";
     String SEL_BATCH_LISTING = "select batch_id,status from batch where volume_id =? AND status != 'UBatched'";
     String UPD_BATCH_LISTING = "update batch set status = 'Listing' where batch_id = ";
     String INS_USRQUEUE_LISTING = "INSERT INTO usersqueue(batch_id,users_id,timestamp) values(?,?,?)";
     String SEL_BATCH_TALLY = "select batch_id,status from batch where volume_id =? AND status != 'UBatched'";
     String UPD_BATCH_TALLY = "update batch set status = 'Tally' where batch_id = ";
     String INS_USRQUEUE_TALLY = "INSERT INTO usersqueue(batch_id,users_id,timestamp) values(?,?,?)";
     String DEL_LISTQC = "delete from listing_qc where listing_qc_id =";
     String SEL_USR_LISTQC = "SELECT U.users_id FROM  users U,listing_qc L  WHERE U.user_name =? AND L.user_name =?";
     String SEL_USR_TALLYQC = "SELECT U.users_id FROM  users U,tally_qc T  WHERE U.user_name =? AND T.user_name =?";
     String SEL_FIELD_TYPE = "SELECT field_type,projectfields_id  FROM projectfields WHERE field_name = ? AND project_id =?";
     String SEL_BATCHID = "SELECT batch_id  FROM batch WHERE volume_id = ? AND status = ?";
     String SEL_CHILDID = "SELECT child_id  FROM child WHERE volume_id = ? AND batch_id = ?";
     String SEL_NV_VALUE = "SELECT NV.value,P.bates_number FROM namevalue NV,page P where NV.field_name = ? AND NV.child_id = ? AND  P.volume_id = ? AND P.child_id =? AND NV.queryraised = ?";
     String SEL_V_VALUE = "SELECT V.value,P.bates_number FROM value V,page P where V.field_name = ? AND V.child_id = ? AND  P.volume_id = ? AND P.child_id =? AND V.queryraised = ?";
     String INS_LISTING_OCC = "INSERT INTO listing_occurrence(project_id,batch_id,child_id,field_id,field_name,field_type,field_value,start_bates,end_bates) VALUES (?,?,?,?,?,?,?,?,?)";
     String INS_TALLY_OCC = "INSERT INTO tally_occurrence(project_id,batch_id,child_id,field_id,field_name,field_type,field_value,start_bates,end_bates) VALUES (?,?,?,?,?,?,?,?,?)";
     String INS_LISTING_OCCR = "INSERT INTO listing_occurrence(project_id,batch_id,child_id,field_id,field_name,field_type,field_value,start_bates,end_bates) VALUES (?,?,?,?,?,?,?,?,?)";
     String INS_TALLY_OCCR = "INSERT INTO tally_occurrence(project_id,batch_id, child_id,field_id,field_name,field_type,field_value,start_bates,end_bates) VALUES (?,?,?,?,?,?,?,?,?)";
     String SEL_DISTINCT_FVALLISTING = "SELECT DISTINCT field_value FROM listing_occurrence where project_id = ? AND field_id = ?";
     String SEL_DISTINCT_FVALTALLY = "SELECT DISTINCT field_value FROM tally_occurrence where project_id = ? AND field_id = ?";
     String SEL_VOLUME_NAME = "SELECT volume_name FROM volume WHERE volume_id = ?";
     String INS_POST_VALIDATION_PVR = "INSERT INTO post_validation (project_id, volume_id, file_name, status, created_by, run_date) values (?,?,?,?,?,?)";
     String SEL_POST_VALIDATION_LAST_RECORD = "SELECT TOP 1 post_validation_id,file_name FROM post_validation ORDER BY post_validation_id DESC";
     String SEL_VALIDATION_MAPPING_MASTER_PVR = "SELECT validation_mapping_master_id FROM validation_mapping_master where validation_functions_master_id = ?";
     String SEL_VALIDATION_MAPPING_DETAILS_PVR = "SELECT parameter FROM validation_mapping_details WHERE projectfields_id = ? AND validation_mapping_master_id = ?";
     String INS_POST_VALIDATION_DETAILS_PVR = "INSERT INTO post_validation_details (post_validation_id, batch_id, child_id, projectfields_id, validation_functions_master_id, result ) VALUES(?, ?, ?, ?, ?, ?)";
     String UPD_POST_VALIDATION_DETAILS_PVR = "UPDATE post_validation set status = 'COMPLETED' WHERE post_validation_id = ?";
     String SEL_VALIDATION_FUNCTIONS_MASTER_PVR = "SELECT function_name FROM validation_functions_master WHERE validation_functions_master_id = ? ";
     String SEL_VALUE_PVR = "SELECT value, field_name FROM value where child_id = ?";
     String SEL_NAME_VALUE_PVR = "SELECT value, field_name FROM namevalue where child_id = ?";
     String SEL_PROJECT_FIELDS_PVR = "SELECT field_name, field_type, field_size FROM projectfields where projectfields_id = ?";
     String SEL_VALIDATION_FUNCTIONS_MASTER_COMP_PVR = "SELECT function_name, description, function_body, error_message FROM validation_functions_master where validation_functions_master_id = ?";
     String SEL_PVR_ID = "SELECT post_validation_id, file_name FROM post_validation";
     String SEL_BATCH_NUM_PVR = "SELECT batch_number FROM batch where batch_id = ?";
     String SEL_DOC_NUM_PVR = "SELECT document_number FROM page WHERE volume_id = ? AND child_id = ?";
     String SEL_CHILD_BATCH_IDS_PVR = "SELECT child_id, batch_id FROM child where volume_id = ?";
     String SEL_PROJECT_NAME_PVR = "SELECT project_name FROM project where project_id= ?";
     String SEL_NAMES_PVR = "SELECT  P.project_name ,V.volume_name ,PV.file_name, U.user_name, PV.run_date FROM post_validation PV INNER JOIN project P ON P.project_id = PV.project_id INNER JOIN volume V ON V.volume_id = PV.volume_id INNER JOIN users U ON U.users_id = PV.created_by where post_validation_id = ?";
     String SEL_PVR_BY_VOLUME = "SELECT PV.post_validation_id ,P.project_name, V.volume_name ,status ,U.user_name ,run_date,file_name FROM post_validation PV INNER JOIN project P ON P.project_id = PV.project_id INNER JOIN volume V ON V.volume_id = PV.volume_id INNER JOIN users U On U.users_id = PV.created_by WHERE P.project_id = ? AND V.volume_id = ? ";
     String SEL_PVR_BY_PROJECT = "SELECT PV.post_validation_id ,P.project_name, V.volume_name ,status ,U.user_name ,run_date,file_name FROM post_validation PV INNER JOIN project P ON P.project_id = PV.project_id INNER JOIN volume V ON V.volume_id = PV.volume_id INNER JOIN users U On U.users_id = PV.created_by WHERE P.project_id = ?";
     String SEL_ALL_PVR = "SELECT PV.post_validation_id ,P.project_name, V.volume_name ,status ,U.user_name ,run_date,file_name FROM post_validation PV INNER JOIN project P ON P.project_id = PV.project_id INNER JOIN volume V ON V.volume_id = PV.volume_id INNER JOIN users U On U.users_id = PV.created_by";
     String GET_ALL_USERS = "select U.users_id, user_name,(first_name+' '+last_name) as Name, unitize, uqc   , coding, codingqc, qa, listing, tally, team_leader, admin, T.team_name from users U  left join teams T on (U.teams_id=T.teams_id) where U.active = 1";
     
     //SQL Queries for Command_Get_QA_FieldValue
     String SEL_PROJECT_DETAILS = "select projectfields_id, field_name, field_type, tag_name, l1_information from projectfields where project_id = ? ORDER BY SEQUENCE";
     String SEL_FIELDVALUE_OF_TYPE_NAME = "select value from namevalue where child_id = ? and field_name = ?";
     String SEL_FIELDVALUE_OF_TYPE_TEXT = "select value from value where child_id = ? and field_name = ?";
     String SEL_QA_CORRECTION_DATA_FOR_FIELD_SAMPLING = "select qa_corrections_id, correction_data, correction_type from qa_corrections where project_fields_id = ? and child_id = ? and sampling_id = ?";
     String SEL_QA_CORRECTION_DATA_FOR_TAG_SAMPLING = "select qa_corrections_id, correction_data, correction_type from qa_corrections where project_fields_id = ? and tag_sequence = ? and child_id = ? and sampling_id = ?";
     String SEL_CHILD_FOR_L1_INFORMATION_FOLDER = "Select TOP 1 child_id from project_l1 where page_id = (select page_id from page where child_id = ? and original_flag != ?)";
     String SEL_CHILD_FOR_L1_INFORMATION_SOURCE = "Select TOP 1 child_id from project_l1 where page_id = (SELECT TOP 1  page_id FROM page WHERE page_id < (select page_id from page where  child_id = ? and original_flag != ?) AND original_flag = ? ORDER BY page_id DESC)";
     String SEL_BATES_NUMBER_FOR_L1_CHILD = "select top 1 bates_number as start_bates from page where child_id = ? and boundary != ? order by bates_number";
     
     //SQL Queries for Command_List_QA_Groups
     String SEL_SAMPLING_DETAILS = "select sg.qa_sampled_group_id, sg.qa_sampled_group_number, a.qa_status, a.users_id from qa_sampled_group sg, qa_assignment a where sg.qa_sampled_group_id in (select distinct qa_sampled_group_id from sampled_documents where volume_id = ?) and sg.qa_sampled_group_id = a.qa_sampled_group_id and a.sampling_id = ?";
     String SEL_QA_LEVEL = "select s.QALevel from sampling s where sampling_id = (select distinct sampling_id from sampled_documents where qa_sampled_group_id = ?)";
     String SEL_SAMPLING_ID = "select top 1 sampling_id, reject_number from sampling where volume_id = ? order by sampling_id desc";
     
     //SQL Queries for Command_Close_QA_Groups
     String UPD_QA_GROUP_STATUS = "update qa_assignment set qa_status = ?, end_time = ? where qa_sampled_group_id = ( select distinct sg.qa_sampled_group_id from qa_sampled_group sg, sampled_documents sp where sg.qa_sampled_group_number = ? and sg.qa_sampled_group_id = sp.qa_sampled_group_id and sp.volume_id = ? and sp.sampling_id = ?)";
     
     //SQL Queries For Command_Save_QA_Correction_Data
     String SEL_QA_CORRECTION_DATA = "select qa_corrections_id from qa_corrections where project_fields_id = ? and tag_sequence = ? and child_id = ? and sampling_id = ?";
     String UPD_QA_CORRECTION_DATA = "update qa_corrections set sampled_documents_id = ?,child_id = ?,project_fields_id = ?,coded_data = ?,correction_data = ?,correction_type = ?,tag_sequence = ?,created_date = ? where qa_corrections_id = ?";
     String INS_QA_CORRECTION_DATA = "Insert into qa_corrections values(?,?,?,?,?,?,?,?,?)";
     
     //SQL Queries For Command_qa_assign_user
     String SEL_SAMPLING_TYPE = "select top 1 samplingType ,sampling_id, reject_number from sampling where volume_id = ? order by sampling_id desc";
     String UPD_QA_ASSIGNMENT = "update qa_assignment set users_id = (select users_id from users where user_name = ? and active = ? ), qa_status = ? where qa_sampled_group_id = (select distinct sg.qa_sampled_group_id from qa_sampled_group sg, sampled_documents sp where sg.qa_sampled_group_number = ? and sg.qa_sampled_group_id = sp.qa_sampled_group_id and sp.volume_id = ? and sp.sampling_id = ?)";
     
     //SQL Queries For Command_show_sampled_document
     String SEL_QA_SAMPLED_DOCUMENT = "select child_id, sampled_documents_id, sampling_id, sampled_fields from sampled_documents where volume_id = ? and qa_sampled_group_id  = (select TOP 1 qa_sampled_group_id from qa_sampled_group where qa_sampled_group_number = ? order by qa_sampled_group_id desc)";
     String SEL_START_BATES_NUMBER = "select top 1 bates_number as start_bates from page where child_id = ? order by bates_number";
     String SEL_END_BATES_NUMBER = "select top 1 bates_number as start_bates from page where child_id = ? order by bates_number desc";
     
     //SQL Queries For Command_QA_Inspection_Report
     String SEL_QA_PR_CORRECTION_DATA_COUNT = "select count(*) from qa_corrections where sampled_documents_id in (select sampled_documents_id from sampled_documents where volume_id = ? and sampling_id = ?)";
     String SEL_QA_PR_DOCUMENT_COUNT = "select count(*) from child where volume_id = ?";
     String SEL_QA_PR_FIELD_COUNT = "select count(*) from projectfields where project_id = ?";
     String SEL_QA_PR_TAG_COUNT = "select sum(tag_count) from project_fields_tag_count where child_id in (select child_id from child where volume_id = ?)";
     String SEL_QA_PR_SAMPLED_DOCUMENT_COUNT = "select count(*) from  sampled_documents where volume_id = ? and sampling_id = ?";
     String SEL_QA_PR_SAMPLED_TAG_COUNT = "select sum(tag_count) from project_fields_tag_count where child_id in (select child_id from sampled_documents where volume_id = ? and sampling_id = ?)";
     String SEL_QA_PR_NUMBER_OF_DOC_WITH_ERROR = "select count(distinct sampled_documents_id) from qa_corrections where sampled_documents_id in (select sampled_documents_id from sampled_documents where volume_id = ? and sampling_id = ?)";
     String SEL_QA_PR_NUMBER_OF_FIELDS_WITH_ERROR = "select count(project_fields_id) from qa_corrections where sampled_documents_id in (select sampled_documents_id from sampled_documents where volume_id = ? and sampling_id = ?) and tag_sequence <= 1";
     String SEL_QA_PR_NUMBER_OF_TAG_WITH_ERROR = "select count(project_fields_id) from qa_corrections where sampled_documents_id in (select sampled_documents_id from sampled_documents where volume_id = ? and sampling_id = ?)";
     String SEL_QA_PR_NUMBER_OF_UNCODED = "select count(*) from qa_corrections where correction_type = ? and sampled_documents_id in (select sampled_documents_id from sampled_documents where volume_id = ? and sampling_id = ?)";
     String SEL_QA_PR_NUMBER_OF_MISCODED = "select count(*) from qa_corrections where correction_type = ? and sampled_documents_id in (select sampled_documents_id from sampled_documents where volume_id = ? and sampling_id = ?)";
     String SEL_QA_PR_NUMBER_OF_ADDED = "select count(*) from qa_corrections where correction_type = ? and sampled_documents_id in (select sampled_documents_id from sampled_documents where volume_id = ? and sampling_id = ?)";
     String SEL_QA_PR_SAMPLING_DETAILS ="select s.sampling_id,s.reject_number, s.samplingMethod, s.samplingType, accuracyRequired,QALevel, AQL from sampling s where s.sampling_id in (select top 1 sampling_id from sampled_documents where volume_id = ? order by sampling_id desc)";
     String SEL_QA_PR_PROJECTS_DETAILS = "select p.project_name, v.volume_name from project p, volume v where p.project_id = ? and v.volume_id = ?";
     String UPD_QA_PR_BATCH_QASTATUS = "update batch set status = ? where batch_id in (select distinct batch_id from child where child_id in (select distinct child_id from qa_corrections where sampled_documents_id in (select sampled_documents_id from sampled_documents where sampling_id = ?)))";
     String UPD_QA_PR_BATCH_STATUS_COMPLETE = "update batch set status = ? where batch_id in (select distinct batch_id from child where child_id in (select distinct child_id from sampled_documents where sampling_id = ?))";
     String UPD_QA_PR_BATCH_STATUS = "update batch set status = ? where volume_id = ? and status = ?";
     String SEL_PROJECT_FIELDS = "select field_name from projectfields where project_id = ?";
     String SEL_CODERS_FOR_GIVEN_VOLUME = "select user_name from users where users_id in (select user_id from codinghistory where volume_id = ? and event = ?)";
     String INS_SAMPLING_DETAILS = "INSERT INTO sampling () values ()";
     String SEL_CHAR_COUNT_FOR_VOLUME = "select sum(value_count) from project_fields_tag_count where child_id in (select child_id from child where volume_id = ?)";
     String UPD_SAMPLING = "update sampling set sampled_char_count = ? where sampling_id = (select TOP 1 sampling_id from sampling where volume_id = ? and sampling_status = ? order by sampling_id desc)";
     String SEL_CHAR_COUNT_OF_UNSAMPLED_DOCUMENT = "select sum(value_count) from project_fields_tag_count where child_id in (select child_id from char_sampled_document where volume_id = ? and char_sampling_flag = ?)";
     String SEL_QA_SAMPLED_CHAR_COUNT = "select sampled_char_count from sampling where sampling_id = ?";
     String SEL_QA_GROUP_ASSIGNMENT = "select users_id from qa_assignment where qa_sampled_group_id = (select distinct sg.qa_sampled_group_id from qa_sampled_group sg, sampled_documents sp where sg.qa_sampled_group_number = ? and sg.qa_sampled_group_id = sp.qa_sampled_group_id and sp.volume_id = ? and sp.sampling_id = ?) and sampling_id =?";    
     String SEL_DOCUMENT_COUNT = "select count(*) from child where volume_id = ?";
     
     String SEL_ASSIGNED_USER = "select users_id from users where user_name = ? and active = 1";
     String SEL_DISTINCT_GROUPID = "select distinct sg.qa_sampled_group_id from qa_sampled_group sg, sampled_documents sp where sg.qa_sampled_group_number = ?  and sg.qa_sampled_group_id = sp.qa_sampled_group_id and sp.volume_id = ?  and sp.sampling_id = ?";
     String UPD_ASSIGNED_USER = "update qa_assignment set users_id = ?, qa_status = 'In Use', start_time = ? where qa_sampled_group_id = ?";
     
     String SEL_SAMPLE_PROJECT_NAME = "select project_id, project_name from project where project_id in (select project_id from volume where volume_id = ? )";
     String SEL_SAMPLE_QALEVEL = "select top 1 QALevel from sampling where project_id = ? and volume_id = ? order by sampling_id desc";
     String INS_SAMPLE_SAMPLING = "INSERT INTO sampling(project_id,volume_id,samplingMethod, accuracyRequired, sampling_status,QALevel) VALUES(?,?,'Fixed-Percentage',?,'In Progress',?)";
     String UPD_SAMPLE_BATCH = "update batch set status ='QA' where volume_id = ? and status = 'TComplete'";
     String SEL_SAMPLE_UNAME = "SELECT user_name from users where users_id = (select distinct user_id from codinghistory where volume_id = ? and event = 'Coding')";
     String SEL_SAMPLE_FIELDNAME = "select field_name from projectfields where project_id = ?";
     String SEL_PARAM_QALEVEL = "select TOP 1 QALevel from sampling where project_id = ? and volume_id = ? ORDER BY QALevel desc";
     String SEL_LOT_BATCH_SIZE = "select lot_batch_size from sampling_codeletters";
     String SEL_CODE_LETTER = "select Level2 from sampling_codeletters where lot_batch_size = ?";
     String SEL_SAMPLE_SIZE = "select sample_size,Accept,Reject from ?  where CodeLetters = ? and AQL = ?";
     String SEL_DISTINCT_CHILD_ID = "select distinct child_id,error_count from childerror";
     String SEL_DIST_CHILD_ID = "select distinct child_id from page where volume_id = ?";
     String SEL_BATCH_ID_BATCH = "SELECT batch_id  FROM batch WHERE volume_id = ? AND status = ?";
     String UPD_STATUS_BATCH = "UPDATE batch SET status = ? where batch_id = ?";
     
     String SEL_GET_PARAM_CHILD_ID = "select distinct child_id from sampled_documents  where volume_id = ";
     String SEL_GET_PARAM_CHILDID = "select distinct child_id from childcoded where child_id = ? and status = 'QA'";
     String SEL_FIELD_COUNT = "select field_count,error_count from childerror where child_id = ?";
     String SEL_TAG_COUNT = "select tags,error_type from codinghistory where child_id = ? and event ='QA'";
     String UPD_END_TIME = "update sampling set end_time = ?,sampling_status = ?,sampling_result = ? where sampling_id = ?";
     String SEL_PARAM_PROJECT_NAME = "select project_name from project where project_id = ?" ;
     String SEL_PARAM_VOLUME_NAME = "select volume_name from volume where volume_id = ?";
     String SEL_PARAM_DISTINCT_CHILD_ID = "select distinct(child_id) from page where volume_id = ?";
     String SEL_PARAM_DISTINCT_FIELD_NAME = "select distinct(field_name) from projectfields where project_id = ?";
     String SEL_PARAM_SAMPLING = "select * from sampling where project_id = ? and volume_id = ? and sampling_status = 'In Progress'";
     String SEL_TALLY_USER_ID = "select user_id from tally_assignment where tally_dictionary_group_id = ?";
     String INS_TALLY_ASSIGNMENT = "INSERT INTO tally_assignment (user_id, tally_status, tally_dictionary_group_id) VALUES ( ?, 'Assigned' ,? )";
     String UPD_TALLY_ASSIGNMENT = "Update tally_assignment set user_id = ?, tally_status = 'Assigned'  where tally_assignment_id = ?";
     
     String SEL_OPEN_BATCH_PROJECTNAME = "select project_name from project where project_id=?";
     String SEL_OPEN_BATCH_PROJECTID = "SELECT  project_id,volume_id FROM ? WHERE  field_name =? AND user_id = ?";
     String UPD_OPEN_BATCH_STATUS = "UPDATE ? SET  status =? where user_id =? AND field_name =?";
     String SEL_OPEN_BATCH_PROJECTFIELDS = "SELECT  projectfields_id FROM projectfields WHERE  field_name = ? AND project_id = ?";
     String SEL_OPEN_BATCH_ASSIGNEDUSER = "SELECT 0 from assignment A WITH(HOLDLOCK) inner join batch B on B.batch_id = A.batch_id WHERE A.batch_id = ? and users_id = ? and B.status = ?";
     String SEL_OPEN_BATCH_BATCHID = "SELECT TOP 1 Q.batch_id FROM usersqueue Q inner join batch B on  B.batch_id = Q.batch_id inner join volume V on V.volume_id = B.volume_id WHERE Q.users_id = ? and V.project_id = ? and B.status = ? order by B.priority desc, B.batch_number";
     String SEL_BATCHID_IN_TEAMSQUEUE = "SELECT TOP 1 Q.batch_id FROM users U inner join teamsqueue Q on Q.teams_id = U.teams_id inner join batch B on B.batch_id = Q.batch_id inner join volume V on V.volume_id = B.volume_id left join usersqueue UQ on UQ.batch_id=Q.batch_id WHERE U.users_id= ? and V.project_id = ? and B.status = ? and UQ.batch_id is null ORDER BY B.priority desc, B.batch_number";
     String SEL_BATCHID_IN_USERS = "SELECT TOP 1 Q.batch_id FROM users U  inner join teamsqueue Q on Q.teams_id = U.teams_id  inner join batch B on B.batch_id =Q.batch_id  inner join volume V on V.volume_id = B.volume_id  left join batchuser BU on BU.batch_id = B.batch_id  left join usersqueue UQ on UQ.batch_id=Q.batch_id WHERE U.users_id= ? and V.project_id = ? and B.status = ? and BU.coder_id <> U.users_id and UQ.batch_id is null ORDER BY B.priority desc, B.batch_number";
     String SEL_BATCHID_IN_TEAMSVOLUME = "SELECT TOP 1 B.batch_id FROM users U    inner join teamsvolume Q on Q.teams_id = U.teams_id    inner join volume V on V.volume_id = Q.volume_id    inner join batch B on B.volume_id = V.volume_id left join assignment A on A.batch_id=B.batch_id left join usersqueue UQ on UQ.batch_id=B.batch_id left join teamsqueue TQ on TQ.batch_id=B.batch_id WHERE U.users_id = ? and V.project_id = ? and B.status = ? and A.batch_id is null and UQ.batch_id is null and TQ.batch_id is null ORDER BY B.priority desc, B.batch_number";
     String SEL_USERID_ASSIGNMENT = "SELECT users_id  FROM assignment A WITH(UPDLOCK) inner join batch B on B.batch_id = A.batch_id WHERE A.batch_id = ?";
     String SEL_BATCH_DETAILS = "SELECT V.volume_id, project_name, priority, split_documents, P.project_id, active_group FROM batch B inner join volume V on V.volume_id = B.volume_id inner join project P on P.project_id = V.project_id where batch_id = ?";
     String UPD_BATCH_USER = "update batchuser set coder_id = ?, mod_time = ? where batch_id = ?";
     String UPD_BATCH_USER_QCID = "update batchuser set qc_id = ?, mod_time = ? where batch_id = ?";
     
}
